{"version":3,"sources":["meteor://ðŸ’»app/client/group/group_item.js","meteor://ðŸ’»app/client/group/group_list.js","meteor://ðŸ’»app/client/group/group_page.js","meteor://ðŸ’»app/client/group/group_submit.js","meteor://ðŸ’»app/client/peerjs/peer.js","meteor://ðŸ’»app/client/peerjs/webrtc-peerjs.js","meteor://ðŸ’»app/client/helpers/config.js","meteor://ðŸ’»app/client/js/create.js","meteor://ðŸ’»app/client/js/home.js","meteor://ðŸ’»app/client/js/meeting.js","meteor://ðŸ’»app/client/js/meetingLeft.js","meteor://ðŸ’»app/lib/Collections/Groups.js","meteor://ðŸ’»app/lib/Collections/Meetings.js","meteor://ðŸ’»app/lib/Collections/Speeches.js","meteor://ðŸ’»app/lib/Router.js"],"names":["Template","groupItem","helpers","ownGroup","userId","Meteor","partGroup","res","i","members","length","user","emails","address","groupsList","groups","Groups","find","groupPage","events","e","preventDefault","confirm","currentGroupId","_id","remove","Router","go","member","update","$pull","parentId","parentData","target","console","log","AddedMember","document","querySelector","$push","value","groupSubmit","onCreated","Session","set","inputs","get","uniqid","Math","floor","random","push","membersInputs","$","name","group","val","call","error","result","alert","reason","input","event","currentTarget","attr","_","filter","x","t","n","r","s","o","u","a","require","f","Error","code","l","exports","module","RTCSessionDescription","window","mozRTCSessionDescription","RTCPeerConnection","mozRTCPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","mozRTCIceCandidate","util","EventEmitter","Negotiator","Reliable","DataConnection","peer","provider","options","extend","serialization","reliable","open","type","id","connectionId","_idPrefix","randomToken","label","metadata","_buffer","_buffering","bufferSize","_chunkedData","_payload","_peerBrowser","browser","startConnection","originator","inherits","prototype","initialize","dc","_dc","dataChannel","_configureDataChannel","self","supports","sctp","binaryType","onopen","emit","_reliable","debug","onmessage","msg","_handleDataMessage","onclose","close","data","datatype","constructor","Blob","blobToArrayBuffer","ab","unpack","ArrayBuffer","String","binaryStringToArrayBuffer","JSON","parse","__peerData","chunkInfo","count","total","cleanup","send","chunked","_bufferedSend","stringify","blob","pack","needsChunking","chunkedBrowsers","size","chunkedMTU","_sendChunks","blobToBinaryString","str","binaryBlob","_trySend","setTimeout","_tryBuffer","shift","blobs","chunk","ii","handleMessage","message","payload","handleSDP","sdp","handleCandidate","candidate","warn","Socket","MediaConnection","Peer","BinaryPack","localStream","_stream","addStream","remoteStream","answer","stream","messages","_getMessages","pcs","media","queue","connection","pc","_getPeerConnection","peerConnection","config","createDataChannel","onnegotiationneeded","_makeOffer","peerConnections","signalingState","_startPeerConnection","optional","RtpDataChannels","DtlsSrtpKeyAgreement","_setupListeners","pc_id","peerId","onicecandidate","evt","socket","dst","oniceconnectionstatechange","iceConnectionState","noop","onicechange","ondatachannel","channel","getConnection","onaddstream","readyState","createOffer","offer","higherBandwidthSDP","setLocalDescription","err","emitError","constraints","_makeAnswer","createAnswer","setRemoteDescription","ice","sdpMLineIndex","addIceCandidate","Object","undefined","toString","host","CLOUD_HOST","port","CLOUD_PORT","key","path","token","defaultConfig","location","hostname","secure","isSecure","logFunction","setLogFunction","setLogLevel","audioVideo","_delayedAbort","validateId","validateKey","destroyed","disconnected","connections","_lostMessages","_initializeServerConnection","_initialize","_retrieveId","on","_handleMessage","_abort","disconnect","cb","http","XMLHttpRequest","protocol","url","queryString","Date","getTime","onerror","pathError","onreadystatechange","status","responseText","start","src","_cleanupPeer","_addConnection","_storeMessage","connect","setZeroTimeout","_lastServerId","destroy","_cleanup","peers","keys","j","jj","reconnect","listAllPeers","helpfulError","_queue","httpProtocol","wsProtocol","_httpUrl","_wsUrl","_startXhrStream","_startWebSocket","_socket","WebSocket","_timeout","clearTimeout","_http","abort","_sendQueuedMessages","_index","_streamIndex","old","_handleStream","_setHTTPTimeout","split","index","bufferedMessage","_wsOpen","toLowerCase","setRequestHeader","dataCount","logLevel","level","debugLevel","parseInt","isNaN","_printWith","_print","fn","Function","prefix","copy","Array","slice","arguments","unshift","apply","reliablePC","reliableDC","negotiationPC","binary","exec","ctor","superCtor","super_","create","enumerable","writable","configurable","dest","source","hasOwnProperty","global","timeouts","messageName","setZeroTimeoutPostMessage","postMessage","stopPropagation","addEventListener","attachEvent","bl","chunks","ceil","end","min","b","fr","FileReader","onload","readAsArrayBuffer","readAsBinaryString","byteArray","Uint8Array","charCodeAt","buffer","substr","EE","context","once","_events","listeners","ee","a1","a2","a3","a4","a5","len","args","removeListener","removeAllListeners","off","addListener","setMaxListeners","EventEmitter2","EventEmitter3","BufferBuilder","binaryFeatures","unpacker","Unpacker","packer","Packer","getBuffer","dataBuffer","dataView","byteLength","unpack_uint8","positive_fixnum","negative_fixnum","unpack_raw","unpack_string","unpack_array","unpack_map","unpack_float","unpack_double","unpack_uint16","unpack_uint32","unpack_uint64","unpack_int8","unpack_int16","unpack_int32","unpack_int64","byte","bytes","read","uint16","uint32","uint64","uint8","pow","buf","c","fromCharCode","objects","map","sign","exp","fraction","h32","l32","hfrac","frac","subarray","bufferBuilder","pack_string","pack_integer","pack_double","append","pack_array","File","pack_bin","useArrayBufferView","pack_object","toBinaryPack","flush","pack_uint8","pack_uint16","pack_uint32","utf8Length","ary","num","pack_int8","pack_int16","pack_int32","pack_int64","pack_uint64","LN2","frac0","frac1","b32","obj","prop","high","low","_utf8Replace","m","replace","useBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","_pieces","_parts","builder","getBlob","_outgoing","_incoming","_received","_window","_mtu","_interval","_count","_setupDC","_handleSend","ack","_chunk","timer","_sendWindowedChunks","_setupInterval","setInterval","_multiple","_intervalSend","_processAcks","item","indexOf","idata","odata","_ack","max","_calculateNextAck","_complete","ch","limit","sent","version","navigator","appVersion","match","parts","isClient","hello","outgoingCall","profile","currentCall","video","getElementById","URL","createObjectURL","users","userIds","Presences","presence","$in","$ne","subscribe","text","$set","incomingCall","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","audio","Accounts","ui","passwordSignupFields","extraSignupFields","fieldName","fieldLabel","inputType","visible","rank","parents","getAttribute","form","nextRank","newInput","cloneNode","ordreInputs","ordreDuJour","ordreTimeInputs","ordreDuJourTemps","participantsInputs","participantsEmails","ordres","ordreTimes","participantActivity","meeting","meetingName","duration","meetingDuration","animatorName","animatorMail","animatorEmail","speaker","meetingId","emailBody","onRendered","username","tempName","d","setHours","datetimepicker","format","defaultDate","home","sortableList","Presence","state","online","currentRoomId","userPres","getSpeaker","Meetings","findOne","isSpeaker","mail","isAsking","Speeches","myMeetingId","speakers","ownMeeting","partMeeting","speeches","newParticipant","querySelectorAll","clearInterval","timerId","sort","currentSpeech","Users","paroles","time","orderChoose","paroleFound","forEach","el","timeLeft","sortable","computeSortable","ready","summernote","height","title","doc","jsPDF","save","meetingReport","isTrue","pptcont","Collection","allow","ownsDocument","insert","methods","groupInsert","groupAttributes","check","author","authorAdress","authorName","submitted","groupId","Mongo","meetingInsert","meetingAttributes","Boolean","Number","speechesInsert","speechesAttributes","meetingID","speechesId","configure","layoutTemplate","waitOn","route","params","_meetingId","notFoundTemplate","MeetingUsers","_userId","render"],"mappings":"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","file":"/app.js","sourcesContent":["Template.groupItem.helpers({\n  ownGroup:function(){\n    return this.userId === Meteor.userId();\n  },\n  partGroup:function(){\n    var res=0;\n    if(this.userId === Meteor.userId()){\n      res=1;\n    }\n    else{\n      for(i=0;i<this.members.length;i++){\n        if(this.members[i]===Meteor.user().emails[0].address){\n          res=1;\n          i=this.members.length;\n        }\n      }\n    }\n    return res;\n  }\n});\n","Template.groupsList.helpers({\n  groups: function() {\n    return Groups.find();\n  }\n});\n","Template.groupPage.helpers({\n  ownGroup:function(){\n    return this.userId === Meteor.userId();\n  },\n  partGroup:function(){\n    var res=0;\n    if(this.userId === Meteor.userId()){\n      res=1;\n    }\n    else{\n      for(i=0;i<this.members.length;i++){\n        if(this.members[i]===Meteor.user().emails[0].address){\n          res=1;\n          i=this.members.length;\n        }\n      }\n    }\n    return res;\n  }\n});\n\nTemplate.groupPage.events({\n\n  'click .delete': function(e) {\n    e.preventDefault();\n\n    if (confirm(\"Delete this group?\")) {\n      var currentGroupId = this._id;\n      Groups.remove(currentGroupId);\n      Router.go('groups');\n\n    }\n  },\n  'click .quit': function(e) {\n    e.preventDefault();\n\n    if (confirm(\"Do you want to leave this group?\")) {\n      var currentGroupId = this._id;\n      var member=Meteor.user().emails[0].address;\n      Groups.update(currentGroupId,{$pull : {members : member}} );\n      Router.go('groups');\n\n    }\n  },\n  'click #min-input': function (e) {\n\n\n    e.preventDefault();\n\n    if (confirm(\"Do you want to kik \" +this +\" ?\")) {\n      var parentId=Template.parentData(1)._id;\n      var target=\"\"+this;\n    //  console.log(\"taille parent : \"+Template.parentData(1).members.length);\n\n\n      console.log(target);\n      Groups.update({_id:parentId},{$pull : {members : target}} );\n    //alert(\"member removed!\");\n    }\n\n  },\n  'click #add-member': function(e) {\n    e.preventDefault();\n    //RÃ©cupÃ©ration des Ã©lÃ©ments DOM des champs de saisie\n    var currentGroupId = this._id;\n\n    var AddedMember = document.querySelector('[name=AddedMember]');\n\n    Groups.update(currentGroupId,{$push : {members : AddedMember.value}} );\n\n    AddedMember.value=\"\";\n  },\n  'click #open': function(e){\n      Router.go('create', this);\n  }\n});\n","Template.groupSubmit.onCreated(function() {\n  Session.set('inputs', []); // on page load, set this to have no inputs\n});\n\nTemplate.groupSubmit.helpers({\n  inputs: function () {\n    return Session.get('inputs'); // reactively watches the Session variable, so when it changes, this result will change and our template will change\n  }\n});\n\n// Now we'll set up a click handler to add inputs to our array when we   click the \"add\" button\nTemplate.groupSubmit.events({\n  'click #add-input': function () {\n\n    var inputs = Session.get('inputs');\n    var uniqid = Math.floor(Math.random() * 100000); // Give a unique ID so you can pull _this_ input when you click remove\n    inputs.push({uniqid: uniqid, value: \"\"});\n    Session.set('inputs', inputs);\n  },\n\n  'submit form': function(e) {\n    e.preventDefault();\n    //RÃ©cupÃ©ration des Ã©lÃ©ments DOM des champs de saisie\n    var membersInputs = $(e.target).find('[name=member]');\n\n\n    //RÃ©cupÃ©ration des valeurs de l'ordre du jour, temps estimÃ©s et des emails d'invitation\n    var name = [];;\n    var members = [];\n\n\n    for (i = 0; i < membersInputs.length; i++) {\n      if (membersInputs[i].value != \"\") {\n        members.push(membersInputs[i].value);\n      }\n    }\n\n  //  name.push(nameInput[0].value);\n\n    var group = {\n      name: $(e.target).find('[name=name]').val(),\n      members\n    }\n\n    Meteor.call('groupInsert', group, function(error, result) {\n      // affiche l'erreur Ã  l'utilisateur et s'interrompt\n      if (error)\n      return alert(error.reason);\n      Router.go('groups', {_id: result._id});\n    });\n  }\n\n\n});\n\n\n// We also need handlers for when the inputs themselves are changed / removed\nTemplate.input.events({\n  'click #remove-input': function(event) {\n    var uniqid = $(event.currentTarget).attr('uniqid');\n    inputs = Session.get('inputs');\n    inputs = _.filter(inputs, function(x) { return x.uniqid != uniqid; });\n    Session.set('inputs', inputs);\n  }/*,\n  'change input': function(event) {\n    var $input = $(event.currentTarget);\n    var uniqid = $input.attr('uniqid');\n    inputs = Session.get('inputs');\n    index = inputs.findIndex(function(x) { return x.uniqid == uniqid; });\n    inputs[index].value = $input.val();\n    Session.set('inputs', inputs);\n  }*/\n});\n","/*! peerjs build:0.3.13, development. Copyright(c) 2013 Michelle Bu <michelle@michellebu.com> */(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nmodule.exports.RTCSessionDescription = window.RTCSessionDescription ||\n\twindow.mozRTCSessionDescription;\nmodule.exports.RTCPeerConnection = window.RTCPeerConnection ||\n\twindow.mozRTCPeerConnection || window.webkitRTCPeerConnection;\nmodule.exports.RTCIceCandidate = window.RTCIceCandidate ||\n\twindow.mozRTCIceCandidate;\n\n},{}],2:[function(require,module,exports){\nvar util = require('./util');\nvar EventEmitter = require('eventemitter3');\nvar Negotiator = require('./negotiator');\nvar Reliable = require('reliable');\n\n/**\n * Wraps a DataChannel between two Peers.\n */\nfunction DataConnection(peer, provider, options) {\n  if (!(this instanceof DataConnection)) return new DataConnection(peer, provider, options);\n  EventEmitter.call(this);\n\n  this.options = util.extend({\n    serialization: 'binary',\n    reliable: false\n  }, options);\n\n  // Connection is not open yet.\n  this.open = false;\n  this.type = 'data';\n  this.peer = peer;\n  this.provider = provider;\n\n  this.id = this.options.connectionId || DataConnection._idPrefix + util.randomToken();\n\n  this.label = this.options.label || this.id;\n  this.metadata = this.options.metadata;\n  this.serialization = this.options.serialization;\n  this.reliable = this.options.reliable;\n\n  // Data channel buffering.\n  this._buffer = [];\n  this._buffering = false;\n  this.bufferSize = 0;\n\n  // For storing large data.\n  this._chunkedData = {};\n\n  if (this.options._payload) {\n    this._peerBrowser = this.options._payload.browser;\n  }\n\n  Negotiator.startConnection(\n    this,\n    this.options._payload || {\n      originator: true\n    }\n  );\n}\n\nutil.inherits(DataConnection, EventEmitter);\n\nDataConnection._idPrefix = 'dc_';\n\n/** Called by the Negotiator when the DataChannel is ready. */\nDataConnection.prototype.initialize = function(dc) {\n  this._dc = this.dataChannel = dc;\n  this._configureDataChannel();\n}\n\nDataConnection.prototype._configureDataChannel = function() {\n  var self = this;\n  if (util.supports.sctp) {\n    this._dc.binaryType = 'arraybuffer';\n  }\n  this._dc.onopen = function() {\n    util.log('Data channel connection success');\n    self.open = true;\n    self.emit('open');\n  }\n\n  // Use the Reliable shim for non Firefox browsers\n  if (!util.supports.sctp && this.reliable) {\n    this._reliable = new Reliable(this._dc, util.debug);\n  }\n\n  if (this._reliable) {\n    this._reliable.onmessage = function(msg) {\n      self.emit('data', msg);\n    };\n  } else {\n    this._dc.onmessage = function(e) {\n      self._handleDataMessage(e);\n    };\n  }\n  this._dc.onclose = function(e) {\n    util.log('DataChannel closed for:', self.peer);\n    self.close();\n  };\n}\n\n// Handles a DataChannel message.\nDataConnection.prototype._handleDataMessage = function(e) {\n  var self = this;\n  var data = e.data;\n  var datatype = data.constructor;\n  if (this.serialization === 'binary' || this.serialization === 'binary-utf8') {\n    if (datatype === Blob) {\n      // Datatype should never be blob\n      util.blobToArrayBuffer(data, function(ab) {\n        data = util.unpack(ab);\n        self.emit('data', data);\n      });\n      return;\n    } else if (datatype === ArrayBuffer) {\n      data = util.unpack(data);\n    } else if (datatype === String) {\n      // String fallback for binary data for browsers that don't support binary yet\n      var ab = util.binaryStringToArrayBuffer(data);\n      data = util.unpack(ab);\n    }\n  } else if (this.serialization === 'json') {\n    data = JSON.parse(data);\n  }\n\n  // Check if we've chunked--if so, piece things back together.\n  // We're guaranteed that this isn't 0.\n  if (data.__peerData) {\n    var id = data.__peerData;\n    var chunkInfo = this._chunkedData[id] || {data: [], count: 0, total: data.total};\n\n    chunkInfo.data[data.n] = data.data;\n    chunkInfo.count += 1;\n\n    if (chunkInfo.total === chunkInfo.count) {\n      // Clean up before making the recursive call to `_handleDataMessage`.\n      delete this._chunkedData[id];\n\n      // We've received all the chunks--time to construct the complete data.\n      data = new Blob(chunkInfo.data);\n      this._handleDataMessage({data: data});\n    }\n\n    this._chunkedData[id] = chunkInfo;\n    return;\n  }\n\n  this.emit('data', data);\n}\n\n/**\n * Exposed functionality for users.\n */\n\n/** Allows user to close connection. */\nDataConnection.prototype.close = function() {\n  if (!this.open) {\n    return;\n  }\n  this.open = false;\n  Negotiator.cleanup(this);\n  this.emit('close');\n}\n\n/** Allows user to send data. */\nDataConnection.prototype.send = function(data, chunked) {\n  if (!this.open) {\n    this.emit('error', new Error('Connection is not open. You should listen for the `open` event before sending messages.'));\n    return;\n  }\n  if (this._reliable) {\n    // Note: reliable shim sending will make it so that you cannot customize\n    // serialization.\n    this._reliable.send(data);\n    return;\n  }\n  var self = this;\n  if (this.serialization === 'json') {\n    this._bufferedSend(JSON.stringify(data));\n  } else if (this.serialization === 'binary' || this.serialization === 'binary-utf8') {\n    var blob = util.pack(data);\n\n    // For Chrome-Firefox interoperability, we need to make Firefox \"chunk\"\n    // the data it sends out.\n    var needsChunking = util.chunkedBrowsers[this._peerBrowser] || util.chunkedBrowsers[util.browser];\n    if (needsChunking && !chunked && blob.size > util.chunkedMTU) {\n      this._sendChunks(blob);\n      return;\n    }\n\n    // DataChannel currently only supports strings.\n    if (!util.supports.sctp) {\n      util.blobToBinaryString(blob, function(str) {\n        self._bufferedSend(str);\n      });\n    } else if (!util.supports.binaryBlob) {\n      // We only do this if we really need to (e.g. blobs are not supported),\n      // because this conversion is costly.\n      util.blobToArrayBuffer(blob, function(ab) {\n        self._bufferedSend(ab);\n      });\n    } else {\n      this._bufferedSend(blob);\n    }\n  } else {\n    this._bufferedSend(data);\n  }\n}\n\nDataConnection.prototype._bufferedSend = function(msg) {\n  if (this._buffering || !this._trySend(msg)) {\n    this._buffer.push(msg);\n    this.bufferSize = this._buffer.length;\n  }\n}\n\n// Returns true if the send succeeds.\nDataConnection.prototype._trySend = function(msg) {\n  try {\n    this._dc.send(msg);\n  } catch (e) {\n    this._buffering = true;\n\n    var self = this;\n    setTimeout(function() {\n      // Try again.\n      self._buffering = false;\n      self._tryBuffer();\n    }, 100);\n    return false;\n  }\n  return true;\n}\n\n// Try to send the first message in the buffer.\nDataConnection.prototype._tryBuffer = function() {\n  if (this._buffer.length === 0) {\n    return;\n  }\n\n  var msg = this._buffer[0];\n\n  if (this._trySend(msg)) {\n    this._buffer.shift();\n    this.bufferSize = this._buffer.length;\n    this._tryBuffer();\n  }\n}\n\nDataConnection.prototype._sendChunks = function(blob) {\n  var blobs = util.chunk(blob);\n  for (var i = 0, ii = blobs.length; i < ii; i += 1) {\n    var blob = blobs[i];\n    this.send(blob, true);\n  }\n}\n\nDataConnection.prototype.handleMessage = function(message) {\n  var payload = message.payload;\n\n  switch (message.type) {\n    case 'ANSWER':\n      this._peerBrowser = payload.browser;\n\n      // Forward to negotiator\n      Negotiator.handleSDP(message.type, this, payload.sdp);\n      break;\n    case 'CANDIDATE':\n      Negotiator.handleCandidate(this, payload.candidate);\n      break;\n    default:\n      util.warn('Unrecognized message type:', message.type, 'from peer:', this.peer);\n      break;\n  }\n}\n\nmodule.exports = DataConnection;\n\n},{\"./negotiator\":5,\"./util\":8,\"eventemitter3\":9,\"reliable\":12}],3:[function(require,module,exports){\nwindow.Socket = require('./socket');\nwindow.MediaConnection = require('./mediaconnection');\nwindow.DataConnection = require('./dataconnection');\nwindow.Peer = require('./peer');\nwindow.RTCPeerConnection = require('./adapter').RTCPeerConnection;\nwindow.RTCSessionDescription = require('./adapter').RTCSessionDescription;\nwindow.RTCIceCandidate = require('./adapter').RTCIceCandidate;\nwindow.Negotiator = require('./negotiator');\nwindow.util = require('./util');\nwindow.BinaryPack = require('js-binarypack');\n\n},{\"./adapter\":1,\"./dataconnection\":2,\"./mediaconnection\":4,\"./negotiator\":5,\"./peer\":6,\"./socket\":7,\"./util\":8,\"js-binarypack\":10}],4:[function(require,module,exports){\nvar util = require('./util');\nvar EventEmitter = require('eventemitter3');\nvar Negotiator = require('./negotiator');\n\n/**\n * Wraps the streaming interface between two Peers.\n */\nfunction MediaConnection(peer, provider, options) {\n  if (!(this instanceof MediaConnection)) return new MediaConnection(peer, provider, options);\n  EventEmitter.call(this);\n\n  this.options = util.extend({}, options);\n\n  this.open = false;\n  this.type = 'media';\n  this.peer = peer;\n  this.provider = provider;\n  this.metadata = this.options.metadata;\n  this.localStream = this.options._stream;\n\n  this.id = this.options.connectionId || MediaConnection._idPrefix + util.randomToken();\n  if (this.localStream) {\n    Negotiator.startConnection(\n      this,\n      {_stream: this.localStream, originator: true}\n    );\n  }\n};\n\nutil.inherits(MediaConnection, EventEmitter);\n\nMediaConnection._idPrefix = 'mc_';\n\nMediaConnection.prototype.addStream = function(remoteStream) {\n  util.log('Receiving stream', remoteStream);\n\n  this.remoteStream = remoteStream;\n  this.emit('stream', remoteStream); // Should we call this `open`?\n\n};\n\nMediaConnection.prototype.handleMessage = function(message) {\n  var payload = message.payload;\n\n  switch (message.type) {\n    case 'ANSWER':\n      // Forward to negotiator\n      Negotiator.handleSDP(message.type, this, payload.sdp);\n      this.open = true;\n      break;\n    case 'CANDIDATE':\n      Negotiator.handleCandidate(this, payload.candidate);\n      break;\n    default:\n      util.warn('Unrecognized message type:', message.type, 'from peer:', this.peer);\n      break;\n  }\n}\n\nMediaConnection.prototype.answer = function(stream) {\n  if (this.localStream) {\n    util.warn('Local stream already exists on this MediaConnection. Are you answering a call twice?');\n    return;\n  }\n\n  this.options._payload._stream = stream;\n\n  this.localStream = stream;\n  Negotiator.startConnection(\n    this,\n    this.options._payload\n  )\n  // Retrieve lost messages stored because PeerConnection not set up.\n  var messages = this.provider._getMessages(this.id);\n  for (var i = 0, ii = messages.length; i < ii; i += 1) {\n    this.handleMessage(messages[i]);\n  }\n  this.open = true;\n};\n\n/**\n * Exposed functionality for users.\n */\n\n/** Allows user to close connection. */\nMediaConnection.prototype.close = function() {\n  if (!this.open) {\n    return;\n  }\n  this.open = false;\n  Negotiator.cleanup(this);\n  this.emit('close')\n};\n\nmodule.exports = MediaConnection;\n\n},{\"./negotiator\":5,\"./util\":8,\"eventemitter3\":9}],5:[function(require,module,exports){\nvar util = require('./util');\nvar RTCPeerConnection = require('./adapter').RTCPeerConnection;\nvar RTCSessionDescription = require('./adapter').RTCSessionDescription;\nvar RTCIceCandidate = require('./adapter').RTCIceCandidate;\n\n/**\n * Manages all negotiations between Peers.\n */\nvar Negotiator = {\n  pcs: {\n    data: {},\n    media: {}\n  }, // type => {peerId: {pc_id: pc}}.\n  //providers: {}, // provider's id => providers (there may be multiple providers/client.\n  queue: [] // connections that are delayed due to a PC being in use.\n}\n\nNegotiator._idPrefix = 'pc_';\n\n/** Returns a PeerConnection object set up correctly (for data, media). */\nNegotiator.startConnection = function(connection, options) {\n  var pc = Negotiator._getPeerConnection(connection, options);\n\n  if (connection.type === 'media' && options._stream) {\n    // Add the stream.\n    pc.addStream(options._stream);\n  }\n\n  // Set the connection's PC.\n  connection.pc = connection.peerConnection = pc;\n  // What do we need to do now?\n  if (options.originator) {\n    if (connection.type === 'data') {\n      // Create the datachannel.\n      var config = {};\n      // Dropping reliable:false support, since it seems to be crashing\n      // Chrome.\n      /*if (util.supports.sctp && !options.reliable) {\n        // If we have canonical reliable support...\n        config = {maxRetransmits: 0};\n      }*/\n      // Fallback to ensure older browsers don't crash.\n      if (!util.supports.sctp) {\n        config = {reliable: options.reliable};\n      }\n      var dc = pc.createDataChannel(connection.label, config);\n      connection.initialize(dc);\n    }\n\n    if (!util.supports.onnegotiationneeded) {\n      Negotiator._makeOffer(connection);\n    }\n  } else {\n    Negotiator.handleSDP('OFFER', connection, options.sdp);\n  }\n}\n\nNegotiator._getPeerConnection = function(connection, options) {\n  if (!Negotiator.pcs[connection.type]) {\n    util.error(connection.type + ' is not a valid connection type. Maybe you overrode the `type` property somewhere.');\n  }\n\n  if (!Negotiator.pcs[connection.type][connection.peer]) {\n    Negotiator.pcs[connection.type][connection.peer] = {};\n  }\n  var peerConnections = Negotiator.pcs[connection.type][connection.peer];\n\n  var pc;\n  // Not multiplexing while FF and Chrome have not-great support for it.\n  /*if (options.multiplex) {\n    ids = Object.keys(peerConnections);\n    for (var i = 0, ii = ids.length; i < ii; i += 1) {\n      pc = peerConnections[ids[i]];\n      if (pc.signalingState === 'stable') {\n        break; // We can go ahead and use this PC.\n      }\n    }\n  } else */\n  if (options.pc) { // Simplest case: PC id already provided for us.\n    pc = Negotiator.pcs[connection.type][connection.peer][options.pc];\n  }\n\n  if (!pc || pc.signalingState !== 'stable') {\n    pc = Negotiator._startPeerConnection(connection);\n  }\n  return pc;\n}\n\n/*\nNegotiator._addProvider = function(provider) {\n  if ((!provider.id && !provider.disconnected) || !provider.socket.open) {\n    // Wait for provider to obtain an ID.\n    provider.on('open', function(id) {\n      Negotiator._addProvider(provider);\n    });\n  } else {\n    Negotiator.providers[provider.id] = provider;\n  }\n}*/\n\n\n/** Start a PC. */\nNegotiator._startPeerConnection = function(connection) {\n  util.log('Creating RTCPeerConnection.');\n\n  var id = Negotiator._idPrefix + util.randomToken();\n  var optional = {};\n\n  if (connection.type === 'data' && !util.supports.sctp) {\n    optional = {optional: [{RtpDataChannels: true}]};\n  } else if (connection.type === 'media') {\n    // Interop req for chrome.\n    optional = {optional: [{DtlsSrtpKeyAgreement: true}]};\n  }\n\n  var pc = new RTCPeerConnection(connection.provider.options.config, optional);\n  Negotiator.pcs[connection.type][connection.peer][id] = pc;\n\n  Negotiator._setupListeners(connection, pc, id);\n\n  return pc;\n}\n\n/** Set up various WebRTC listeners. */\nNegotiator._setupListeners = function(connection, pc, pc_id) {\n  var peerId = connection.peer;\n  var connectionId = connection.id;\n  var provider = connection.provider;\n\n  // ICE CANDIDATES.\n  util.log('Listening for ICE candidates.');\n  pc.onicecandidate = function(evt) {\n    if (evt.candidate) {\n      util.log('Received ICE candidates for:', connection.peer);\n      provider.socket.send({\n        type: 'CANDIDATE',\n        payload: {\n          candidate: evt.candidate,\n          type: connection.type,\n          connectionId: connection.id\n        },\n        dst: peerId\n      });\n    }\n  };\n\n  pc.oniceconnectionstatechange = function() {\n    switch (pc.iceConnectionState) {\n      case 'disconnected':\n      case 'failed':\n        util.log('iceConnectionState is disconnected, closing connections to ' + peerId);\n        connection.close();\n        break;\n      case 'completed':\n        pc.onicecandidate = util.noop;\n        break;\n    }\n  };\n\n  // Fallback for older Chrome impls.\n  pc.onicechange = pc.oniceconnectionstatechange;\n\n  // ONNEGOTIATIONNEEDED (Chrome)\n  util.log('Listening for `negotiationneeded`');\n  pc.onnegotiationneeded = function() {\n    util.log('`negotiationneeded` triggered');\n    if (pc.signalingState == 'stable') {\n      Negotiator._makeOffer(connection);\n    } else {\n      util.log('onnegotiationneeded triggered when not stable. Is another connection being established?');\n    }\n  };\n\n  // DATACONNECTION.\n  util.log('Listening for data channel');\n  // Fired between offer and answer, so options should already be saved\n  // in the options hash.\n  pc.ondatachannel = function(evt) {\n    util.log('Received data channel');\n    var dc = evt.channel;\n    var connection = provider.getConnection(peerId, connectionId);\n    connection.initialize(dc);\n  };\n\n  // MEDIACONNECTION.\n  util.log('Listening for remote stream');\n  pc.onaddstream = function(evt) {\n    util.log('Received remote stream');\n    var stream = evt.stream;\n    var connection = provider.getConnection(peerId, connectionId);\n    // 10/10/2014: looks like in Chrome 38, onaddstream is triggered after\n    // setting the remote description. Our connection object in these cases\n    // is actually a DATA connection, so addStream fails.\n    // TODO: This is hopefully just a temporary fix. We should try to\n    // understand why this is happening.\n    if (connection.type === 'media') {\n      connection.addStream(stream);\n    }\n  };\n}\n\nNegotiator.cleanup = function(connection) {\n  util.log('Cleaning up PeerConnection to ' + connection.peer);\n\n  var pc = connection.pc;\n\n  if (!!pc && (pc.readyState !== 'closed' || pc.signalingState !== 'closed')) {\n    pc.close();\n    connection.pc = null;\n  }\n}\n\nNegotiator._makeOffer = function(connection) {\n  var pc = connection.pc;\n  pc.createOffer(function(offer) {\n    util.log('Created offer.');\n\n    if (!util.supports.sctp && connection.type === 'data' && connection.reliable) {\n      offer.sdp = Reliable.higherBandwidthSDP(offer.sdp);\n    }\n\n    pc.setLocalDescription(offer, function() {\n      util.log('Set localDescription: offer', 'for:', connection.peer);\n      connection.provider.socket.send({\n        type: 'OFFER',\n        payload: {\n          sdp: offer,\n          type: connection.type,\n          label: connection.label,\n          connectionId: connection.id,\n          reliable: connection.reliable,\n          serialization: connection.serialization,\n          metadata: connection.metadata,\n          browser: util.browser\n        },\n        dst: connection.peer\n      });\n    }, function(err) {\n      connection.provider.emitError('webrtc', err);\n      util.log('Failed to setLocalDescription, ', err);\n    });\n  }, function(err) {\n    connection.provider.emitError('webrtc', err);\n    util.log('Failed to createOffer, ', err);\n  }, connection.options.constraints);\n}\n\nNegotiator._makeAnswer = function(connection) {\n  var pc = connection.pc;\n\n  pc.createAnswer(function(answer) {\n    util.log('Created answer.');\n\n    if (!util.supports.sctp && connection.type === 'data' && connection.reliable) {\n      answer.sdp = Reliable.higherBandwidthSDP(answer.sdp);\n    }\n\n    pc.setLocalDescription(answer, function() {\n      util.log('Set localDescription: answer', 'for:', connection.peer);\n      connection.provider.socket.send({\n        type: 'ANSWER',\n        payload: {\n          sdp: answer,\n          type: connection.type,\n          connectionId: connection.id,\n          browser: util.browser\n        },\n        dst: connection.peer\n      });\n    }, function(err) {\n      connection.provider.emitError('webrtc', err);\n      util.log('Failed to setLocalDescription, ', err);\n    });\n  }, function(err) {\n    connection.provider.emitError('webrtc', err);\n    util.log('Failed to create answer, ', err);\n  });\n}\n\n/** Handle an SDP. */\nNegotiator.handleSDP = function(type, connection, sdp) {\n  sdp = new RTCSessionDescription(sdp);\n  var pc = connection.pc;\n\n  util.log('Setting remote description', sdp);\n  pc.setRemoteDescription(sdp, function() {\n    util.log('Set remoteDescription:', type, 'for:', connection.peer);\n\n    if (type === 'OFFER') {\n      Negotiator._makeAnswer(connection);\n    }\n  }, function(err) {\n    connection.provider.emitError('webrtc', err);\n    util.log('Failed to setRemoteDescription, ', err);\n  });\n}\n\n/** Handle a candidate. */\nNegotiator.handleCandidate = function(connection, ice) {\n  var candidate = ice.candidate;\n  var sdpMLineIndex = ice.sdpMLineIndex;\n  connection.pc.addIceCandidate(new RTCIceCandidate({\n    sdpMLineIndex: sdpMLineIndex,\n    candidate: candidate\n  }));\n  util.log('Added ICE candidate for:', connection.peer);\n}\n\nmodule.exports = Negotiator;\n\n},{\"./adapter\":1,\"./util\":8}],6:[function(require,module,exports){\nvar util = require('./util');\nvar EventEmitter = require('eventemitter3');\nvar Socket = require('./socket');\nvar MediaConnection = require('./mediaconnection');\nvar DataConnection = require('./dataconnection');\n\n/**\n * A peer who can initiate connections with other peers.\n */\nfunction Peer(id, options) {\n  if (!(this instanceof Peer)) return new Peer(id, options);\n  EventEmitter.call(this);\n\n  // Deal with overloading\n  if (id && id.constructor == Object) {\n    options = id;\n    id = undefined;\n  } else if (id) {\n    // Ensure id is a string\n    id = id.toString();\n  }\n  //\n\n  // Configurize options\n  options = util.extend({\n    debug: 0, // 1: Errors, 2: Warnings, 3: All logs\n    host: util.CLOUD_HOST,\n    port: util.CLOUD_PORT,\n    key: 'peerjs',\n    path: '/',\n    token: util.randomToken(),\n    config: util.defaultConfig\n  }, options);\n  this.options = options;\n  // Detect relative URL host.\n  if (options.host === '/') {\n    options.host = window.location.hostname;\n  }\n  // Set path correctly.\n  if (options.path[0] !== '/') {\n    options.path = '/' + options.path;\n  }\n  if (options.path[options.path.length - 1] !== '/') {\n    options.path += '/';\n  }\n\n  // Set whether we use SSL to same as current host\n  if (options.secure === undefined && options.host !== util.CLOUD_HOST) {\n    options.secure = util.isSecure();\n  }\n  // Set a custom log function if present\n  if (options.logFunction) {\n    util.setLogFunction(options.logFunction);\n  }\n  util.setLogLevel(options.debug);\n  //\n\n  // Sanity checks\n  // Ensure WebRTC supported\n  if (!util.supports.audioVideo && !util.supports.data ) {\n    this._delayedAbort('browser-incompatible', 'The current browser does not support WebRTC');\n    return;\n  }\n  // Ensure alphanumeric id\n  if (!util.validateId(id)) {\n    this._delayedAbort('invalid-id', 'ID \"' + id + '\" is invalid');\n    return;\n  }\n  // Ensure valid key\n  if (!util.validateKey(options.key)) {\n    this._delayedAbort('invalid-key', 'API KEY \"' + options.key + '\" is invalid');\n    return;\n  }\n  // Ensure not using unsecure cloud server on SSL page\n  if (options.secure && options.host === '0.peerjs.com') {\n    this._delayedAbort('ssl-unavailable',\n      'The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS.');\n    return;\n  }\n  //\n\n  // States.\n  this.destroyed = false; // Connections have been killed\n  this.disconnected = false; // Connection to PeerServer killed but P2P connections still active\n  this.open = false; // Sockets and such are not yet open.\n  //\n\n  // References\n  this.connections = {}; // DataConnections for this peer.\n  this._lostMessages = {}; // src => [list of messages]\n  //\n\n  // Start the server connection\n  this._initializeServerConnection();\n  if (id) {\n    this._initialize(id);\n  } else {\n    this._retrieveId();\n  }\n  //\n}\n\nutil.inherits(Peer, EventEmitter);\n\n// Initialize the 'socket' (which is actually a mix of XHR streaming and\n// websockets.)\nPeer.prototype._initializeServerConnection = function() {\n  var self = this;\n  this.socket = new Socket(this.options.secure, this.options.host, this.options.port, this.options.path, this.options.key);\n  this.socket.on('message', function(data) {\n    self._handleMessage(data);\n  });\n  this.socket.on('error', function(error) {\n    self._abort('socket-error', error);\n  });\n  this.socket.on('disconnected', function() {\n    // If we haven't explicitly disconnected, emit error and disconnect.\n    if (!self.disconnected) {\n      self.emitError('network', 'Lost connection to server.');\n      self.disconnect();\n    }\n  });\n  this.socket.on('close', function() {\n    // If we haven't explicitly disconnected, emit error.\n    if (!self.disconnected) {\n      self._abort('socket-closed', 'Underlying socket is already closed.');\n    }\n  });\n};\n\n/** Get a unique ID from the server via XHR. */\nPeer.prototype._retrieveId = function(cb) {\n  var self = this;\n  var http = new XMLHttpRequest();\n  var protocol = this.options.secure ? 'https://' : 'http://';\n  var url = protocol + this.options.host + ':' + this.options.port +\n    this.options.path + this.options.key + '/id';\n  var queryString = '?ts=' + new Date().getTime() + '' + Math.random();\n  url += queryString;\n\n  // If there's no ID we need to wait for one before trying to init socket.\n  http.open('get', url, true);\n  http.onerror = function(e) {\n    util.error('Error retrieving ID', e);\n    var pathError = '';\n    if (self.options.path === '/' && self.options.host !== util.CLOUD_HOST) {\n      pathError = ' If you passed in a `path` to your self-hosted PeerServer, ' +\n        'you\\'ll also need to pass in that same path when creating a new ' +\n        'Peer.';\n    }\n    self._abort('server-error', 'Could not get an ID from the server.' + pathError);\n  };\n  http.onreadystatechange = function() {\n    if (http.readyState !== 4) {\n      return;\n    }\n    if (http.status !== 200) {\n      http.onerror();\n      return;\n    }\n    self._initialize(http.responseText);\n  };\n  http.send(null);\n};\n\n/** Initialize a connection with the server. */\nPeer.prototype._initialize = function(id) {\n  this.id = id;\n  this.socket.start(this.id, this.options.token);\n};\n\n/** Handles messages from the server. */\nPeer.prototype._handleMessage = function(message) {\n  var type = message.type;\n  var payload = message.payload;\n  var peer = message.src;\n  var connection;\n\n  switch (type) {\n    case 'OPEN': // The connection to the server is open.\n      this.emit('open', this.id);\n      this.open = true;\n      break;\n    case 'ERROR': // Server error.\n      this._abort('server-error', payload.msg);\n      break;\n    case 'ID-TAKEN': // The selected ID is taken.\n      this._abort('unavailable-id', 'ID `' + this.id + '` is taken');\n      break;\n    case 'INVALID-KEY': // The given API key cannot be found.\n      this._abort('invalid-key', 'API KEY \"' + this.options.key + '\" is invalid');\n      break;\n\n    //\n    case 'LEAVE': // Another peer has closed its connection to this peer.\n      util.log('Received leave message from', peer);\n      this._cleanupPeer(peer);\n      break;\n\n    case 'EXPIRE': // The offer sent to a peer has expired without response.\n      this.emitError('peer-unavailable', 'Could not connect to peer ' + peer);\n      break;\n    case 'OFFER': // we should consider switching this to CALL/CONNECT, but this is the least breaking option.\n      var connectionId = payload.connectionId;\n      connection = this.getConnection(peer, connectionId);\n\n      if (connection) {\n        util.warn('Offer received for existing Connection ID:', connectionId);\n        //connection.handleMessage(message);\n      } else {\n        // Create a new connection.\n        if (payload.type === 'media') {\n          connection = new MediaConnection(peer, this, {\n            connectionId: connectionId,\n            _payload: payload,\n            metadata: payload.metadata\n          });\n          this._addConnection(peer, connection);\n          this.emit('call', connection);\n        } else if (payload.type === 'data') {\n          connection = new DataConnection(peer, this, {\n            connectionId: connectionId,\n            _payload: payload,\n            metadata: payload.metadata,\n            label: payload.label,\n            serialization: payload.serialization,\n            reliable: payload.reliable\n          });\n          this._addConnection(peer, connection);\n          this.emit('connection', connection);\n        } else {\n          util.warn('Received malformed connection type:', payload.type);\n          return;\n        }\n        // Find messages.\n        var messages = this._getMessages(connectionId);\n        for (var i = 0, ii = messages.length; i < ii; i += 1) {\n          connection.handleMessage(messages[i]);\n        }\n      }\n      break;\n    default:\n      if (!payload) {\n        util.warn('You received a malformed message from ' + peer + ' of type ' + type);\n        return;\n      }\n\n      var id = payload.connectionId;\n      connection = this.getConnection(peer, id);\n\n      if (connection && connection.pc) {\n        // Pass it on.\n        connection.handleMessage(message);\n      } else if (id) {\n        // Store for possible later use\n        this._storeMessage(id, message);\n      } else {\n        util.warn('You received an unrecognized message:', message);\n      }\n      break;\n  }\n};\n\n/** Stores messages without a set up connection, to be claimed later. */\nPeer.prototype._storeMessage = function(connectionId, message) {\n  if (!this._lostMessages[connectionId]) {\n    this._lostMessages[connectionId] = [];\n  }\n  this._lostMessages[connectionId].push(message);\n};\n\n/** Retrieve messages from lost message store */\nPeer.prototype._getMessages = function(connectionId) {\n  var messages = this._lostMessages[connectionId];\n  if (messages) {\n    delete this._lostMessages[connectionId];\n    return messages;\n  } else {\n    return [];\n  }\n};\n\n/**\n * Returns a DataConnection to the specified peer. See documentation for a\n * complete list of options.\n */\nPeer.prototype.connect = function(peer, options) {\n  if (this.disconnected) {\n    util.warn('You cannot connect to a new Peer because you called ' +\n      '.disconnect() on this Peer and ended your connection with the ' +\n      'server. You can create a new Peer to reconnect, or call reconnect ' +\n      'on this peer if you believe its ID to still be available.');\n    this.emitError('disconnected', 'Cannot connect to new Peer after disconnecting from server.');\n    return;\n  }\n  var connection = new DataConnection(peer, this, options);\n  this._addConnection(peer, connection);\n  return connection;\n};\n\n/**\n * Returns a MediaConnection to the specified peer. See documentation for a\n * complete list of options.\n */\nPeer.prototype.call = function(peer, stream, options) {\n  if (this.disconnected) {\n    util.warn('You cannot connect to a new Peer because you called ' +\n      '.disconnect() on this Peer and ended your connection with the ' +\n      'server. You can create a new Peer to reconnect.');\n    this.emitError('disconnected', 'Cannot connect to new Peer after disconnecting from server.');\n    return;\n  }\n  if (!stream) {\n    util.error('To call a peer, you must provide a stream from your browser\\'s `getUserMedia`.');\n    return;\n  }\n  options = options || {};\n  options._stream = stream;\n  var call = new MediaConnection(peer, this, options);\n  this._addConnection(peer, call);\n  return call;\n};\n\n/** Add a data/media connection to this peer. */\nPeer.prototype._addConnection = function(peer, connection) {\n  if (!this.connections[peer]) {\n    this.connections[peer] = [];\n  }\n  this.connections[peer].push(connection);\n};\n\n/** Retrieve a data/media connection for this peer. */\nPeer.prototype.getConnection = function(peer, id) {\n  var connections = this.connections[peer];\n  if (!connections) {\n    return null;\n  }\n  for (var i = 0, ii = connections.length; i < ii; i++) {\n    if (connections[i].id === id) {\n      return connections[i];\n    }\n  }\n  return null;\n};\n\nPeer.prototype._delayedAbort = function(type, message) {\n  var self = this;\n  util.setZeroTimeout(function(){\n    self._abort(type, message);\n  });\n};\n\n/**\n * Destroys the Peer and emits an error message.\n * The Peer is not destroyed if it's in a disconnected state, in which case\n * it retains its disconnected state and its existing connections.\n */\nPeer.prototype._abort = function(type, message) {\n  util.error('Aborting!');\n  if (!this._lastServerId) {\n    this.destroy();\n  } else {\n    this.disconnect();\n  }\n  this.emitError(type, message);\n};\n\n/** Emits a typed error message. */\nPeer.prototype.emitError = function(type, err) {\n  util.error('Error:', err);\n  if (typeof err === 'string') {\n    err = new Error(err);\n  }\n  err.type = type;\n  this.emit('error', err);\n};\n\n/**\n * Destroys the Peer: closes all active connections as well as the connection\n *  to the server.\n * Warning: The peer can no longer create or accept connections after being\n *  destroyed.\n */\nPeer.prototype.destroy = function() {\n  if (!this.destroyed) {\n    this._cleanup();\n    this.disconnect();\n    this.destroyed = true;\n  }\n};\n\n\n/** Disconnects every connection on this peer. */\nPeer.prototype._cleanup = function() {\n  if (this.connections) {\n    var peers = Object.keys(this.connections);\n    for (var i = 0, ii = peers.length; i < ii; i++) {\n      this._cleanupPeer(peers[i]);\n    }\n  }\n  this.emit('close');\n};\n\n/** Closes all connections to this peer. */\nPeer.prototype._cleanupPeer = function(peer) {\n  var connections = this.connections[peer];\n  for (var j = 0, jj = connections.length; j < jj; j += 1) {\n    connections[j].close();\n  }\n};\n\n/**\n * Disconnects the Peer's connection to the PeerServer. Does not close any\n *  active connections.\n * Warning: The peer can no longer create or accept connections after being\n *  disconnected. It also cannot reconnect to the server.\n */\nPeer.prototype.disconnect = function() {\n  var self = this;\n  util.setZeroTimeout(function(){\n    if (!self.disconnected) {\n      self.disconnected = true;\n      self.open = false;\n      if (self.socket) {\n        self.socket.close();\n      }\n      self.emit('disconnected', self.id);\n      self._lastServerId = self.id;\n      self.id = null;\n    }\n  });\n};\n\n/** Attempts to reconnect with the same ID. */\nPeer.prototype.reconnect = function() {\n  if (this.disconnected && !this.destroyed) {\n    util.log('Attempting reconnection to server with ID ' + this._lastServerId);\n    this.disconnected = false;\n    this._initializeServerConnection();\n    this._initialize(this._lastServerId);\n  } else if (this.destroyed) {\n    throw new Error('This peer cannot reconnect to the server. It has already been destroyed.');\n  } else if (!this.disconnected && !this.open) {\n    // Do nothing. We're still connecting the first time.\n    util.error('In a hurry? We\\'re still trying to make the initial connection!');\n  } else {\n    throw new Error('Peer ' + this.id + ' cannot reconnect because it is not disconnected from the server!');\n  }\n};\n\n/**\n * Get a list of available peer IDs. If you're running your own server, you'll\n * want to set allow_discovery: true in the PeerServer options. If you're using\n * the cloud server, email team@peerjs.com to get the functionality enabled for\n * your key.\n */\nPeer.prototype.listAllPeers = function(cb) {\n  cb = cb || function() {};\n  var self = this;\n  var http = new XMLHttpRequest();\n  var protocol = this.options.secure ? 'https://' : 'http://';\n  var url = protocol + this.options.host + ':' + this.options.port +\n    this.options.path + this.options.key + '/peers';\n  var queryString = '?ts=' + new Date().getTime() + '' + Math.random();\n  url += queryString;\n\n  // If there's no ID we need to wait for one before trying to init socket.\n  http.open('get', url, true);\n  http.onerror = function(e) {\n    self._abort('server-error', 'Could not get peers from the server.');\n    cb([]);\n  };\n  http.onreadystatechange = function() {\n    if (http.readyState !== 4) {\n      return;\n    }\n    if (http.status === 401) {\n      var helpfulError = '';\n      if (self.options.host !== util.CLOUD_HOST) {\n        helpfulError = 'It looks like you\\'re using the cloud server. You can email ' +\n          'team@peerjs.com to enable peer listing for your API key.';\n      } else {\n        helpfulError = 'You need to enable `allow_discovery` on your self-hosted ' +\n          'PeerServer to use this feature.';\n      }\n      cb([]);\n      throw new Error('It doesn\\'t look like you have permission to list peers IDs. ' + helpfulError);\n    } else if (http.status !== 200) {\n      cb([]);\n    } else {\n      cb(JSON.parse(http.responseText));\n    }\n  };\n  http.send(null);\n};\n\nmodule.exports = Peer;\n\n},{\"./dataconnection\":2,\"./mediaconnection\":4,\"./socket\":7,\"./util\":8,\"eventemitter3\":9}],7:[function(require,module,exports){\nvar util = require('./util');\nvar EventEmitter = require('eventemitter3');\n\n/**\n * An abstraction on top of WebSockets and XHR streaming to provide fastest\n * possible connection for peers.\n */\nfunction Socket(secure, host, port, path, key) {\n  if (!(this instanceof Socket)) return new Socket(secure, host, port, path, key);\n\n  EventEmitter.call(this);\n\n  // Disconnected manually.\n  this.disconnected = false;\n  this._queue = [];\n\n  var httpProtocol = secure ? 'https://' : 'http://';\n  var wsProtocol = secure ? 'wss://' : 'ws://';\n  this._httpUrl = httpProtocol + host + ':' + port + path + key;\n  this._wsUrl = wsProtocol + host + ':' + port + path + 'peerjs?key=' + key;\n}\n\nutil.inherits(Socket, EventEmitter);\n\n\n/** Check in with ID or get one from server. */\nSocket.prototype.start = function(id, token) {\n  this.id = id;\n\n  this._httpUrl += '/' + id + '/' + token;\n  this._wsUrl += '&id=' + id + '&token=' + token;\n\n  this._startXhrStream();\n  this._startWebSocket();\n}\n\n\n/** Start up websocket communications. */\nSocket.prototype._startWebSocket = function(id) {\n  var self = this;\n\n  if (this._socket) {\n    return;\n  }\n\n  this._socket = new WebSocket(this._wsUrl);\n\n  this._socket.onmessage = function(event) {\n    try {\n      var data = JSON.parse(event.data);\n    } catch(e) {\n      util.log('Invalid server message', event.data);\n      return;\n    }\n    self.emit('message', data);\n  };\n\n  this._socket.onclose = function(event) {\n    util.log('Socket closed.');\n    self.disconnected = true;\n    self.emit('disconnected');\n  };\n\n  // Take care of the queue of connections if necessary and make sure Peer knows\n  // socket is open.\n  this._socket.onopen = function() {\n    if (self._timeout) {\n      clearTimeout(self._timeout);\n      setTimeout(function(){\n        self._http.abort();\n        self._http = null;\n      }, 5000);\n    }\n    self._sendQueuedMessages();\n    util.log('Socket open');\n  };\n}\n\n/** Start XHR streaming. */\nSocket.prototype._startXhrStream = function(n) {\n  try {\n    var self = this;\n    this._http = new XMLHttpRequest();\n    this._http._index = 1;\n    this._http._streamIndex = n || 0;\n    this._http.open('post', this._httpUrl + '/id?i=' + this._http._streamIndex, true);\n    this._http.onerror = function() {\n      // If we get an error, likely something went wrong.\n      // Stop streaming.\n      clearTimeout(self._timeout);\n      self.emit('disconnected');\n    }\n    this._http.onreadystatechange = function() {\n      if (this.readyState == 2 && this.old) {\n        this.old.abort();\n        delete this.old;\n      } else if (this.readyState > 2 && this.status === 200 && this.responseText) {\n        self._handleStream(this);\n      }\n    };\n    this._http.send(null);\n    this._setHTTPTimeout();\n  } catch(e) {\n    util.log('XMLHttpRequest not available; defaulting to WebSockets');\n  }\n}\n\n\n/** Handles onreadystatechange response as a stream. */\nSocket.prototype._handleStream = function(http) {\n  // 3 and 4 are loading/done state. All others are not relevant.\n  var messages = http.responseText.split('\\n');\n\n  // Check to see if anything needs to be processed on buffer.\n  if (http._buffer) {\n    while (http._buffer.length > 0) {\n      var index = http._buffer.shift();\n      var bufferedMessage = messages[index];\n      try {\n        bufferedMessage = JSON.parse(bufferedMessage);\n      } catch(e) {\n        http._buffer.shift(index);\n        break;\n      }\n      this.emit('message', bufferedMessage);\n    }\n  }\n\n  var message = messages[http._index];\n  if (message) {\n    http._index += 1;\n    // Buffering--this message is incomplete and we'll get to it next time.\n    // This checks if the httpResponse ended in a `\\n`, in which case the last\n    // element of messages should be the empty string.\n    if (http._index === messages.length) {\n      if (!http._buffer) {\n        http._buffer = [];\n      }\n      http._buffer.push(http._index - 1);\n    } else {\n      try {\n        message = JSON.parse(message);\n      } catch(e) {\n        util.log('Invalid server message', message);\n        return;\n      }\n      this.emit('message', message);\n    }\n  }\n}\n\nSocket.prototype._setHTTPTimeout = function() {\n  var self = this;\n  this._timeout = setTimeout(function() {\n    var old = self._http;\n    if (!self._wsOpen()) {\n      self._startXhrStream(old._streamIndex + 1);\n      self._http.old = old;\n    } else {\n      old.abort();\n    }\n  }, 25000);\n}\n\n/** Is the websocket currently open? */\nSocket.prototype._wsOpen = function() {\n  return this._socket && this._socket.readyState == 1;\n}\n\n/** Send queued messages. */\nSocket.prototype._sendQueuedMessages = function() {\n  for (var i = 0, ii = this._queue.length; i < ii; i += 1) {\n    this.send(this._queue[i]);\n  }\n}\n\n/** Exposed send for DC & Peer. */\nSocket.prototype.send = function(data) {\n  if (this.disconnected) {\n    return;\n  }\n\n  // If we didn't get an ID yet, we can't yet send anything so we should queue\n  // up these messages.\n  if (!this.id) {\n    this._queue.push(data);\n    return;\n  }\n\n  if (!data.type) {\n    this.emit('error', 'Invalid message');\n    return;\n  }\n\n  var message = JSON.stringify(data);\n  if (this._wsOpen()) {\n    this._socket.send(message);\n  } else {\n    var http = new XMLHttpRequest();\n    var url = this._httpUrl + '/' + data.type.toLowerCase();\n    http.open('post', url, true);\n    http.setRequestHeader('Content-Type', 'application/json');\n    http.send(message);\n  }\n}\n\nSocket.prototype.close = function() {\n  if (!this.disconnected && this._wsOpen()) {\n    this._socket.close();\n    this.disconnected = true;\n  }\n}\n\nmodule.exports = Socket;\n\n},{\"./util\":8,\"eventemitter3\":9}],8:[function(require,module,exports){\nvar defaultConfig = {'iceServers': [{ 'url': 'stun:stun.l.google.com:19302' }]};\nvar dataCount = 1;\n\nvar BinaryPack = require('js-binarypack');\nvar RTCPeerConnection = require('./adapter').RTCPeerConnection;\n\nvar util = {\n  noop: function() {},\n\n  CLOUD_HOST: '0.peerjs.com',\n  CLOUD_PORT: 9000,\n\n  // Browsers that need chunking:\n  chunkedBrowsers: {'Chrome': 1},\n  chunkedMTU: 16300, // The original 60000 bytes setting does not work when sending data from Firefox to Chrome, which is \"cut off\" after 16384 bytes and delivered individually.\n\n  // Logging logic\n  logLevel: 0,\n  setLogLevel: function(level) {\n    var debugLevel = parseInt(level, 10);\n    if (!isNaN(parseInt(level, 10))) {\n      util.logLevel = debugLevel;\n    } else {\n      // If they are using truthy/falsy values for debug\n      util.logLevel = level ? 3 : 0;\n    }\n    util.log = util.warn = util.error = util.noop;\n    if (util.logLevel > 0) {\n      util.error = util._printWith('ERROR');\n    }\n    if (util.logLevel > 1) {\n      util.warn = util._printWith('WARNING');\n    }\n    if (util.logLevel > 2) {\n      util.log = util._print;\n    }\n  },\n  setLogFunction: function(fn) {\n    if (fn.constructor !== Function) {\n      util.warn('The log function you passed in is not a function. Defaulting to regular logs.');\n    } else {\n      util._print = fn;\n    }\n  },\n\n  _printWith: function(prefix) {\n    return function() {\n      var copy = Array.prototype.slice.call(arguments);\n      copy.unshift(prefix);\n      util._print.apply(util, copy);\n    };\n  },\n  _print: function () {\n    var err = false;\n    var copy = Array.prototype.slice.call(arguments);\n    copy.unshift('PeerJS: ');\n    for (var i = 0, l = copy.length; i < l; i++){\n      if (copy[i] instanceof Error) {\n        copy[i] = '(' + copy[i].name + ') ' + copy[i].message;\n        err = true;\n      }\n    }\n    err ? console.error.apply(console, copy) : console.log.apply(console, copy);\n  },\n  //\n\n  // Returns browser-agnostic default config\n  defaultConfig: defaultConfig,\n  //\n\n  // Returns the current browser.\n  browser: (function() {\n    if (window.mozRTCPeerConnection) {\n      return 'Firefox';\n    } else if (window.webkitRTCPeerConnection) {\n      return 'Chrome';\n    } else if (window.RTCPeerConnection) {\n      return 'Supported';\n    } else {\n      return 'Unsupported';\n    }\n  })(),\n  //\n\n  // Lists which features are supported\n  supports: (function() {\n    if (typeof RTCPeerConnection === 'undefined') {\n      return {};\n    }\n\n    var data = true;\n    var audioVideo = true;\n\n    var binaryBlob = false;\n    var sctp = false;\n    var onnegotiationneeded = !!window.webkitRTCPeerConnection;\n\n    var pc, dc;\n    try {\n      pc = new RTCPeerConnection(defaultConfig, {optional: [{RtpDataChannels: true}]});\n    } catch (e) {\n      data = false;\n      audioVideo = false;\n    }\n\n    if (data) {\n      try {\n        dc = pc.createDataChannel('_PEERJSTEST');\n      } catch (e) {\n        data = false;\n      }\n    }\n\n    if (data) {\n      // Binary test\n      try {\n        dc.binaryType = 'blob';\n        binaryBlob = true;\n      } catch (e) {\n      }\n\n      // Reliable test.\n      // Unfortunately Chrome is a bit unreliable about whether or not they\n      // support reliable.\n      var reliablePC = new RTCPeerConnection(defaultConfig, {});\n      try {\n        var reliableDC = reliablePC.createDataChannel('_PEERJSRELIABLETEST', {});\n        sctp = reliableDC.reliable;\n      } catch (e) {\n      }\n      reliablePC.close();\n    }\n\n    // FIXME: not really the best check...\n    if (audioVideo) {\n      audioVideo = !!pc.addStream;\n    }\n\n    // FIXME: this is not great because in theory it doesn't work for\n    // av-only browsers (?).\n    if (!onnegotiationneeded && data) {\n      // sync default check.\n      var negotiationPC = new RTCPeerConnection(defaultConfig, {optional: [{RtpDataChannels: true}]});\n      negotiationPC.onnegotiationneeded = function() {\n        onnegotiationneeded = true;\n        // async check.\n        if (util && util.supports) {\n          util.supports.onnegotiationneeded = true;\n        }\n      };\n      negotiationPC.createDataChannel('_PEERJSNEGOTIATIONTEST');\n\n      setTimeout(function() {\n        negotiationPC.close();\n      }, 1000);\n    }\n\n    if (pc) {\n      pc.close();\n    }\n\n    return {\n      audioVideo: audioVideo,\n      data: data,\n      binaryBlob: binaryBlob,\n      binary: sctp, // deprecated; sctp implies binary support.\n      reliable: sctp, // deprecated; sctp implies reliable data.\n      sctp: sctp,\n      onnegotiationneeded: onnegotiationneeded\n    };\n  }()),\n  //\n\n  // Ensure alphanumeric ids\n  validateId: function(id) {\n    // Allow empty ids\n    return !id || /^[A-Za-z0-9_-]+(?:[ _-][A-Za-z0-9]+)*$/.exec(id);\n  },\n\n  validateKey: function(key) {\n    // Allow empty keys\n    return !key || /^[A-Za-z0-9_-]+(?:[ _-][A-Za-z0-9]+)*$/.exec(key);\n  },\n\n\n  debug: false,\n\n  inherits: function(ctor, superCtor) {\n    ctor.super_ = superCtor;\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  },\n  extend: function(dest, source) {\n    for(var key in source) {\n      if(source.hasOwnProperty(key)) {\n        dest[key] = source[key];\n      }\n    }\n    return dest;\n  },\n  pack: BinaryPack.pack,\n  unpack: BinaryPack.unpack,\n\n  log: function () {\n    if (util.debug) {\n      var err = false;\n      var copy = Array.prototype.slice.call(arguments);\n      copy.unshift('PeerJS: ');\n      for (var i = 0, l = copy.length; i < l; i++){\n        if (copy[i] instanceof Error) {\n          copy[i] = '(' + copy[i].name + ') ' + copy[i].message;\n          err = true;\n        }\n      }\n      err ? console.error.apply(console, copy) : console.log.apply(console, copy);\n    }\n  },\n\n  setZeroTimeout: (function(global) {\n    var timeouts = [];\n    var messageName = 'zero-timeout-message';\n\n    // Like setTimeout, but only takes a function argument.\t There's\n    // no time argument (always zero) and no arguments (you have to\n    // use a closure).\n    function setZeroTimeoutPostMessage(fn) {\n      timeouts.push(fn);\n      global.postMessage(messageName, '*');\n    }\n\n    function handleMessage(event) {\n      if (event.source == global && event.data == messageName) {\n        if (event.stopPropagation) {\n          event.stopPropagation();\n        }\n        if (timeouts.length) {\n          timeouts.shift()();\n        }\n      }\n    }\n    if (global.addEventListener) {\n      global.addEventListener('message', handleMessage, true);\n    } else if (global.attachEvent) {\n      global.attachEvent('onmessage', handleMessage);\n    }\n    return setZeroTimeoutPostMessage;\n  }(window)),\n\n  // Binary stuff\n\n  // chunks a blob.\n  chunk: function(bl) {\n    var chunks = [];\n    var size = bl.size;\n    var start = index = 0;\n    var total = Math.ceil(size / util.chunkedMTU);\n    while (start < size) {\n      var end = Math.min(size, start + util.chunkedMTU);\n      var b = bl.slice(start, end);\n\n      var chunk = {\n        __peerData: dataCount,\n        n: index,\n        data: b,\n        total: total\n      };\n\n      chunks.push(chunk);\n\n      start = end;\n      index += 1;\n    }\n    dataCount += 1;\n    return chunks;\n  },\n\n  blobToArrayBuffer: function(blob, cb){\n    var fr = new FileReader();\n    fr.onload = function(evt) {\n      cb(evt.target.result);\n    };\n    fr.readAsArrayBuffer(blob);\n  },\n  blobToBinaryString: function(blob, cb){\n    var fr = new FileReader();\n    fr.onload = function(evt) {\n      cb(evt.target.result);\n    };\n    fr.readAsBinaryString(blob);\n  },\n  binaryStringToArrayBuffer: function(binary) {\n    var byteArray = new Uint8Array(binary.length);\n    for (var i = 0; i < binary.length; i++) {\n      byteArray[i] = binary.charCodeAt(i) & 0xff;\n    }\n    return byteArray.buffer;\n  },\n  randomToken: function () {\n    return Math.random().toString(36).substr(2);\n  },\n  //\n\n  isSecure: function() {\n    return location.protocol === 'https:';\n  }\n};\n\nmodule.exports = util;\n\n},{\"./adapter\":1,\"js-binarypack\":10}],9:[function(require,module,exports){\n'use strict';\n\n/**\n * Representation of a single EventEmitter function.\n *\n * @param {Function} fn Event handler to be called.\n * @param {Mixed} context Context for function execution.\n * @param {Boolean} once Only emit once\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal EventEmitter interface that is molded against the Node.js\n * EventEmitter interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() { /* Nothing to set */ }\n\n/**\n * Holds the assigned EventEmitters by name.\n *\n * @type {Object}\n * @private\n */\nEventEmitter.prototype._events = undefined;\n\n/**\n * Return a list of assigned event listeners.\n *\n * @param {String} event The events that should be listed.\n * @returns {Array}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  if (!this._events || !this._events[event]) return [];\n\n  for (var i = 0, l = this._events[event].length, ee = []; i < l; i++) {\n    ee.push(this._events[event][i].fn);\n  }\n\n  return ee;\n};\n\n/**\n * Emit an event to all registered event listeners.\n *\n * @param {String} event The name of the event.\n * @returns {Boolean} Indication if we've emitted an event.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  if (!this._events || !this._events[event]) return false;\n\n  var listeners = this._events[event]\n    , length = listeners.length\n    , len = arguments.length\n    , ee = listeners[0]\n    , args\n    , i, j;\n\n  if (1 === length) {\n    if (ee.once) this.removeListener(event, ee.fn, true);\n\n    switch (len) {\n      case 1: return ee.fn.call(ee.context), true;\n      case 2: return ee.fn.call(ee.context, a1), true;\n      case 3: return ee.fn.call(ee.context, a1, a2), true;\n      case 4: return ee.fn.call(ee.context, a1, a2, a3), true;\n      case 5: return ee.fn.call(ee.context, a1, a2, a3, a4), true;\n      case 6: return ee.fn.call(ee.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    ee.fn.apply(ee.context, args);\n  } else {\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Functon} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  if (!this._events) this._events = {};\n  if (!this._events[event]) this._events[event] = [];\n  this._events[event].push(new EE( fn, context || this ));\n\n  return this;\n};\n\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  if (!this._events) this._events = {};\n  if (!this._events[event]) this._events[event] = [];\n  this._events[event].push(new EE(fn, context || this, true ));\n\n  return this;\n};\n\n/**\n * Remove event listeners.\n *\n * @param {String} event The event we want to remove.\n * @param {Function} fn The listener that we need to find.\n * @param {Boolean} once Only remove once listeners.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, once) {\n  if (!this._events || !this._events[event]) return this;\n\n  var listeners = this._events[event]\n    , events = [];\n\n  if (fn) for (var i = 0, length = listeners.length; i < length; i++) {\n    if (listeners[i].fn !== fn && listeners[i].once !== once) {\n      events.push(listeners[i]);\n    }\n  }\n\n  //\n  // Reset the array, or remove it completely if we have no more listeners.\n  //\n  if (events.length) this._events[event] = events;\n  else this._events[event] = null;\n\n  return this;\n};\n\n/**\n * Remove all listeners or only the listeners for the specified event.\n *\n * @param {String} event The event want to remove all listeners for.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  if (!this._events) return this;\n\n  if (event) this._events[event] = null;\n  else this._events = {};\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the module.\n//\nEventEmitter.EventEmitter = EventEmitter;\nEventEmitter.EventEmitter2 = EventEmitter;\nEventEmitter.EventEmitter3 = EventEmitter;\n\nif ('object' === typeof module && module.exports) {\n  module.exports = EventEmitter;\n}\n\n},{}],10:[function(require,module,exports){\nvar BufferBuilder = require('./bufferbuilder').BufferBuilder;\nvar binaryFeatures = require('./bufferbuilder').binaryFeatures;\n\nvar BinaryPack = {\n  unpack: function(data){\n    var unpacker = new Unpacker(data);\n    return unpacker.unpack();\n  },\n  pack: function(data){\n    var packer = new Packer();\n    packer.pack(data);\n    var buffer = packer.getBuffer();\n    return buffer;\n  }\n};\n\nmodule.exports = BinaryPack;\n\nfunction Unpacker (data){\n  // Data is ArrayBuffer\n  this.index = 0;\n  this.dataBuffer = data;\n  this.dataView = new Uint8Array(this.dataBuffer);\n  this.length = this.dataBuffer.byteLength;\n}\n\nUnpacker.prototype.unpack = function(){\n  var type = this.unpack_uint8();\n  if (type < 0x80){\n    var positive_fixnum = type;\n    return positive_fixnum;\n  } else if ((type ^ 0xe0) < 0x20){\n    var negative_fixnum = (type ^ 0xe0) - 0x20;\n    return negative_fixnum;\n  }\n  var size;\n  if ((size = type ^ 0xa0) <= 0x0f){\n    return this.unpack_raw(size);\n  } else if ((size = type ^ 0xb0) <= 0x0f){\n    return this.unpack_string(size);\n  } else if ((size = type ^ 0x90) <= 0x0f){\n    return this.unpack_array(size);\n  } else if ((size = type ^ 0x80) <= 0x0f){\n    return this.unpack_map(size);\n  }\n  switch(type){\n    case 0xc0:\n      return null;\n    case 0xc1:\n      return undefined;\n    case 0xc2:\n      return false;\n    case 0xc3:\n      return true;\n    case 0xca:\n      return this.unpack_float();\n    case 0xcb:\n      return this.unpack_double();\n    case 0xcc:\n      return this.unpack_uint8();\n    case 0xcd:\n      return this.unpack_uint16();\n    case 0xce:\n      return this.unpack_uint32();\n    case 0xcf:\n      return this.unpack_uint64();\n    case 0xd0:\n      return this.unpack_int8();\n    case 0xd1:\n      return this.unpack_int16();\n    case 0xd2:\n      return this.unpack_int32();\n    case 0xd3:\n      return this.unpack_int64();\n    case 0xd4:\n      return undefined;\n    case 0xd5:\n      return undefined;\n    case 0xd6:\n      return undefined;\n    case 0xd7:\n      return undefined;\n    case 0xd8:\n      size = this.unpack_uint16();\n      return this.unpack_string(size);\n    case 0xd9:\n      size = this.unpack_uint32();\n      return this.unpack_string(size);\n    case 0xda:\n      size = this.unpack_uint16();\n      return this.unpack_raw(size);\n    case 0xdb:\n      size = this.unpack_uint32();\n      return this.unpack_raw(size);\n    case 0xdc:\n      size = this.unpack_uint16();\n      return this.unpack_array(size);\n    case 0xdd:\n      size = this.unpack_uint32();\n      return this.unpack_array(size);\n    case 0xde:\n      size = this.unpack_uint16();\n      return this.unpack_map(size);\n    case 0xdf:\n      size = this.unpack_uint32();\n      return this.unpack_map(size);\n  }\n}\n\nUnpacker.prototype.unpack_uint8 = function(){\n  var byte = this.dataView[this.index] & 0xff;\n  this.index++;\n  return byte;\n};\n\nUnpacker.prototype.unpack_uint16 = function(){\n  var bytes = this.read(2);\n  var uint16 =\n    ((bytes[0] & 0xff) * 256) + (bytes[1] & 0xff);\n  this.index += 2;\n  return uint16;\n}\n\nUnpacker.prototype.unpack_uint32 = function(){\n  var bytes = this.read(4);\n  var uint32 =\n     ((bytes[0]  * 256 +\n       bytes[1]) * 256 +\n       bytes[2]) * 256 +\n       bytes[3];\n  this.index += 4;\n  return uint32;\n}\n\nUnpacker.prototype.unpack_uint64 = function(){\n  var bytes = this.read(8);\n  var uint64 =\n   ((((((bytes[0]  * 256 +\n       bytes[1]) * 256 +\n       bytes[2]) * 256 +\n       bytes[3]) * 256 +\n       bytes[4]) * 256 +\n       bytes[5]) * 256 +\n       bytes[6]) * 256 +\n       bytes[7];\n  this.index += 8;\n  return uint64;\n}\n\n\nUnpacker.prototype.unpack_int8 = function(){\n  var uint8 = this.unpack_uint8();\n  return (uint8 < 0x80 ) ? uint8 : uint8 - (1 << 8);\n};\n\nUnpacker.prototype.unpack_int16 = function(){\n  var uint16 = this.unpack_uint16();\n  return (uint16 < 0x8000 ) ? uint16 : uint16 - (1 << 16);\n}\n\nUnpacker.prototype.unpack_int32 = function(){\n  var uint32 = this.unpack_uint32();\n  return (uint32 < Math.pow(2, 31) ) ? uint32 :\n    uint32 - Math.pow(2, 32);\n}\n\nUnpacker.prototype.unpack_int64 = function(){\n  var uint64 = this.unpack_uint64();\n  return (uint64 < Math.pow(2, 63) ) ? uint64 :\n    uint64 - Math.pow(2, 64);\n}\n\nUnpacker.prototype.unpack_raw = function(size){\n  if ( this.length < this.index + size){\n    throw new Error('BinaryPackFailure: index is out of range'\n      + ' ' + this.index + ' ' + size + ' ' + this.length);\n  }\n  var buf = this.dataBuffer.slice(this.index, this.index + size);\n  this.index += size;\n\n    //buf = util.bufferToString(buf);\n\n  return buf;\n}\n\nUnpacker.prototype.unpack_string = function(size){\n  var bytes = this.read(size);\n  var i = 0, str = '', c, code;\n  while(i < size){\n    c = bytes[i];\n    if ( c < 128){\n      str += String.fromCharCode(c);\n      i++;\n    } else if ((c ^ 0xc0) < 32){\n      code = ((c ^ 0xc0) << 6) | (bytes[i+1] & 63);\n      str += String.fromCharCode(code);\n      i += 2;\n    } else {\n      code = ((c & 15) << 12) | ((bytes[i+1] & 63) << 6) |\n        (bytes[i+2] & 63);\n      str += String.fromCharCode(code);\n      i += 3;\n    }\n  }\n  this.index += size;\n  return str;\n}\n\nUnpacker.prototype.unpack_array = function(size){\n  var objects = new Array(size);\n  for(var i = 0; i < size ; i++){\n    objects[i] = this.unpack();\n  }\n  return objects;\n}\n\nUnpacker.prototype.unpack_map = function(size){\n  var map = {};\n  for(var i = 0; i < size ; i++){\n    var key  = this.unpack();\n    var value = this.unpack();\n    map[key] = value;\n  }\n  return map;\n}\n\nUnpacker.prototype.unpack_float = function(){\n  var uint32 = this.unpack_uint32();\n  var sign = uint32 >> 31;\n  var exp  = ((uint32 >> 23) & 0xff) - 127;\n  var fraction = ( uint32 & 0x7fffff ) | 0x800000;\n  return (sign == 0 ? 1 : -1) *\n    fraction * Math.pow(2, exp - 23);\n}\n\nUnpacker.prototype.unpack_double = function(){\n  var h32 = this.unpack_uint32();\n  var l32 = this.unpack_uint32();\n  var sign = h32 >> 31;\n  var exp  = ((h32 >> 20) & 0x7ff) - 1023;\n  var hfrac = ( h32 & 0xfffff ) | 0x100000;\n  var frac = hfrac * Math.pow(2, exp - 20) +\n    l32   * Math.pow(2, exp - 52);\n  return (sign == 0 ? 1 : -1) * frac;\n}\n\nUnpacker.prototype.read = function(length){\n  var j = this.index;\n  if (j + length <= this.length) {\n    return this.dataView.subarray(j, j + length);\n  } else {\n    throw new Error('BinaryPackFailure: read index out of range');\n  }\n}\n\nfunction Packer(){\n  this.bufferBuilder = new BufferBuilder();\n}\n\nPacker.prototype.getBuffer = function(){\n  return this.bufferBuilder.getBuffer();\n}\n\nPacker.prototype.pack = function(value){\n  var type = typeof(value);\n  if (type == 'string'){\n    this.pack_string(value);\n  } else if (type == 'number'){\n    if (Math.floor(value) === value){\n      this.pack_integer(value);\n    } else{\n      this.pack_double(value);\n    }\n  } else if (type == 'boolean'){\n    if (value === true){\n      this.bufferBuilder.append(0xc3);\n    } else if (value === false){\n      this.bufferBuilder.append(0xc2);\n    }\n  } else if (type == 'undefined'){\n    this.bufferBuilder.append(0xc0);\n  } else if (type == 'object'){\n    if (value === null){\n      this.bufferBuilder.append(0xc0);\n    } else {\n      var constructor = value.constructor;\n      if (constructor == Array){\n        this.pack_array(value);\n      } else if (constructor == Blob || constructor == File) {\n        this.pack_bin(value);\n      } else if (constructor == ArrayBuffer) {\n        if(binaryFeatures.useArrayBufferView) {\n          this.pack_bin(new Uint8Array(value));\n        } else {\n          this.pack_bin(value);\n        }\n      } else if ('BYTES_PER_ELEMENT' in value){\n        if(binaryFeatures.useArrayBufferView) {\n          this.pack_bin(new Uint8Array(value.buffer));\n        } else {\n          this.pack_bin(value.buffer);\n        }\n      } else if (constructor == Object){\n        this.pack_object(value);\n      } else if (constructor == Date){\n        this.pack_string(value.toString());\n      } else if (typeof value.toBinaryPack == 'function'){\n        this.bufferBuilder.append(value.toBinaryPack());\n      } else {\n        throw new Error('Type \"' + constructor.toString() + '\" not yet supported');\n      }\n    }\n  } else {\n    throw new Error('Type \"' + type + '\" not yet supported');\n  }\n  this.bufferBuilder.flush();\n}\n\n\nPacker.prototype.pack_bin = function(blob){\n  var length = blob.length || blob.byteLength || blob.size;\n  if (length <= 0x0f){\n    this.pack_uint8(0xa0 + length);\n  } else if (length <= 0xffff){\n    this.bufferBuilder.append(0xda) ;\n    this.pack_uint16(length);\n  } else if (length <= 0xffffffff){\n    this.bufferBuilder.append(0xdb);\n    this.pack_uint32(length);\n  } else{\n    throw new Error('Invalid length');\n  }\n  this.bufferBuilder.append(blob);\n}\n\nPacker.prototype.pack_string = function(str){\n  var length = utf8Length(str);\n\n  if (length <= 0x0f){\n    this.pack_uint8(0xb0 + length);\n  } else if (length <= 0xffff){\n    this.bufferBuilder.append(0xd8) ;\n    this.pack_uint16(length);\n  } else if (length <= 0xffffffff){\n    this.bufferBuilder.append(0xd9);\n    this.pack_uint32(length);\n  } else{\n    throw new Error('Invalid length');\n  }\n  this.bufferBuilder.append(str);\n}\n\nPacker.prototype.pack_array = function(ary){\n  var length = ary.length;\n  if (length <= 0x0f){\n    this.pack_uint8(0x90 + length);\n  } else if (length <= 0xffff){\n    this.bufferBuilder.append(0xdc)\n    this.pack_uint16(length);\n  } else if (length <= 0xffffffff){\n    this.bufferBuilder.append(0xdd);\n    this.pack_uint32(length);\n  } else{\n    throw new Error('Invalid length');\n  }\n  for(var i = 0; i < length ; i++){\n    this.pack(ary[i]);\n  }\n}\n\nPacker.prototype.pack_integer = function(num){\n  if ( -0x20 <= num && num <= 0x7f){\n    this.bufferBuilder.append(num & 0xff);\n  } else if (0x00 <= num && num <= 0xff){\n    this.bufferBuilder.append(0xcc);\n    this.pack_uint8(num);\n  } else if (-0x80 <= num && num <= 0x7f){\n    this.bufferBuilder.append(0xd0);\n    this.pack_int8(num);\n  } else if ( 0x0000 <= num && num <= 0xffff){\n    this.bufferBuilder.append(0xcd);\n    this.pack_uint16(num);\n  } else if (-0x8000 <= num && num <= 0x7fff){\n    this.bufferBuilder.append(0xd1);\n    this.pack_int16(num);\n  } else if ( 0x00000000 <= num && num <= 0xffffffff){\n    this.bufferBuilder.append(0xce);\n    this.pack_uint32(num);\n  } else if (-0x80000000 <= num && num <= 0x7fffffff){\n    this.bufferBuilder.append(0xd2);\n    this.pack_int32(num);\n  } else if (-0x8000000000000000 <= num && num <= 0x7FFFFFFFFFFFFFFF){\n    this.bufferBuilder.append(0xd3);\n    this.pack_int64(num);\n  } else if (0x0000000000000000 <= num && num <= 0xFFFFFFFFFFFFFFFF){\n    this.bufferBuilder.append(0xcf);\n    this.pack_uint64(num);\n  } else{\n    throw new Error('Invalid integer');\n  }\n}\n\nPacker.prototype.pack_double = function(num){\n  var sign = 0;\n  if (num < 0){\n    sign = 1;\n    num = -num;\n  }\n  var exp  = Math.floor(Math.log(num) / Math.LN2);\n  var frac0 = num / Math.pow(2, exp) - 1;\n  var frac1 = Math.floor(frac0 * Math.pow(2, 52));\n  var b32   = Math.pow(2, 32);\n  var h32 = (sign << 31) | ((exp+1023) << 20) |\n      (frac1 / b32) & 0x0fffff;\n  var l32 = frac1 % b32;\n  this.bufferBuilder.append(0xcb);\n  this.pack_int32(h32);\n  this.pack_int32(l32);\n}\n\nPacker.prototype.pack_object = function(obj){\n  var keys = Object.keys(obj);\n  var length = keys.length;\n  if (length <= 0x0f){\n    this.pack_uint8(0x80 + length);\n  } else if (length <= 0xffff){\n    this.bufferBuilder.append(0xde);\n    this.pack_uint16(length);\n  } else if (length <= 0xffffffff){\n    this.bufferBuilder.append(0xdf);\n    this.pack_uint32(length);\n  } else{\n    throw new Error('Invalid length');\n  }\n  for(var prop in obj){\n    if (obj.hasOwnProperty(prop)){\n      this.pack(prop);\n      this.pack(obj[prop]);\n    }\n  }\n}\n\nPacker.prototype.pack_uint8 = function(num){\n  this.bufferBuilder.append(num);\n}\n\nPacker.prototype.pack_uint16 = function(num){\n  this.bufferBuilder.append(num >> 8);\n  this.bufferBuilder.append(num & 0xff);\n}\n\nPacker.prototype.pack_uint32 = function(num){\n  var n = num & 0xffffffff;\n  this.bufferBuilder.append((n & 0xff000000) >>> 24);\n  this.bufferBuilder.append((n & 0x00ff0000) >>> 16);\n  this.bufferBuilder.append((n & 0x0000ff00) >>>  8);\n  this.bufferBuilder.append((n & 0x000000ff));\n}\n\nPacker.prototype.pack_uint64 = function(num){\n  var high = num / Math.pow(2, 32);\n  var low  = num % Math.pow(2, 32);\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\n  this.bufferBuilder.append((high & 0x0000ff00) >>>  8);\n  this.bufferBuilder.append((high & 0x000000ff));\n  this.bufferBuilder.append((low  & 0xff000000) >>> 24);\n  this.bufferBuilder.append((low  & 0x00ff0000) >>> 16);\n  this.bufferBuilder.append((low  & 0x0000ff00) >>>  8);\n  this.bufferBuilder.append((low  & 0x000000ff));\n}\n\nPacker.prototype.pack_int8 = function(num){\n  this.bufferBuilder.append(num & 0xff);\n}\n\nPacker.prototype.pack_int16 = function(num){\n  this.bufferBuilder.append((num & 0xff00) >> 8);\n  this.bufferBuilder.append(num & 0xff);\n}\n\nPacker.prototype.pack_int32 = function(num){\n  this.bufferBuilder.append((num >>> 24) & 0xff);\n  this.bufferBuilder.append((num & 0x00ff0000) >>> 16);\n  this.bufferBuilder.append((num & 0x0000ff00) >>> 8);\n  this.bufferBuilder.append((num & 0x000000ff));\n}\n\nPacker.prototype.pack_int64 = function(num){\n  var high = Math.floor(num / Math.pow(2, 32));\n  var low  = num % Math.pow(2, 32);\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\n  this.bufferBuilder.append((high & 0x0000ff00) >>>  8);\n  this.bufferBuilder.append((high & 0x000000ff));\n  this.bufferBuilder.append((low  & 0xff000000) >>> 24);\n  this.bufferBuilder.append((low  & 0x00ff0000) >>> 16);\n  this.bufferBuilder.append((low  & 0x0000ff00) >>>  8);\n  this.bufferBuilder.append((low  & 0x000000ff));\n}\n\nfunction _utf8Replace(m){\n  var code = m.charCodeAt(0);\n\n  if(code <= 0x7ff) return '00';\n  if(code <= 0xffff) return '000';\n  if(code <= 0x1fffff) return '0000';\n  if(code <= 0x3ffffff) return '00000';\n  return '000000';\n}\n\nfunction utf8Length(str){\n  if (str.length > 600) {\n    // Blob method faster for large strings\n    return (new Blob([str])).size;\n  } else {\n    return str.replace(/[^\\u0000-\\u007F]/g, _utf8Replace).length;\n  }\n}\n\n},{\"./bufferbuilder\":11}],11:[function(require,module,exports){\nvar binaryFeatures = {};\nbinaryFeatures.useBlobBuilder = (function(){\n  try {\n    new Blob([]);\n    return false;\n  } catch (e) {\n    return true;\n  }\n})();\n\nbinaryFeatures.useArrayBufferView = !binaryFeatures.useBlobBuilder && (function(){\n  try {\n    return (new Blob([new Uint8Array([])])).size === 0;\n  } catch (e) {\n    return true;\n  }\n})();\n\nmodule.exports.binaryFeatures = binaryFeatures;\nvar BlobBuilder = module.exports.BlobBuilder;\nif (typeof window != 'undefined') {\n  BlobBuilder = module.exports.BlobBuilder = window.WebKitBlobBuilder ||\n    window.MozBlobBuilder || window.MSBlobBuilder || window.BlobBuilder;\n}\n\nfunction BufferBuilder(){\n  this._pieces = [];\n  this._parts = [];\n}\n\nBufferBuilder.prototype.append = function(data) {\n  if(typeof data === 'number') {\n    this._pieces.push(data);\n  } else {\n    this.flush();\n    this._parts.push(data);\n  }\n};\n\nBufferBuilder.prototype.flush = function() {\n  if (this._pieces.length > 0) {\n    var buf = new Uint8Array(this._pieces);\n    if(!binaryFeatures.useArrayBufferView) {\n      buf = buf.buffer;\n    }\n    this._parts.push(buf);\n    this._pieces = [];\n  }\n};\n\nBufferBuilder.prototype.getBuffer = function() {\n  this.flush();\n  if(binaryFeatures.useBlobBuilder) {\n    var builder = new BlobBuilder();\n    for(var i = 0, ii = this._parts.length; i < ii; i++) {\n      builder.append(this._parts[i]);\n    }\n    return builder.getBlob();\n  } else {\n    return new Blob(this._parts);\n  }\n};\n\nmodule.exports.BufferBuilder = BufferBuilder;\n\n},{}],12:[function(require,module,exports){\nvar util = require('./util');\n\n/**\n * Reliable transfer for Chrome Canary DataChannel impl.\n * Author: @michellebu\n */\nfunction Reliable(dc, debug) {\n  if (!(this instanceof Reliable)) return new Reliable(dc);\n  this._dc = dc;\n\n  util.debug = debug;\n\n  // Messages sent/received so far.\n  // id: { ack: n, chunks: [...] }\n  this._outgoing = {};\n  // id: { ack: ['ack', id, n], chunks: [...] }\n  this._incoming = {};\n  this._received = {};\n\n  // Window size.\n  this._window = 1000;\n  // MTU.\n  this._mtu = 500;\n  // Interval for setInterval. In ms.\n  this._interval = 0;\n\n  // Messages sent.\n  this._count = 0;\n\n  // Outgoing message queue.\n  this._queue = [];\n\n  this._setupDC();\n};\n\n// Send a message reliably.\nReliable.prototype.send = function(msg) {\n  // Determine if chunking is necessary.\n  var bl = util.pack(msg);\n  if (bl.size < this._mtu) {\n    this._handleSend(['no', bl]);\n    return;\n  }\n\n  this._outgoing[this._count] = {\n    ack: 0,\n    chunks: this._chunk(bl)\n  };\n\n  if (util.debug) {\n    this._outgoing[this._count].timer = new Date();\n  }\n\n  // Send prelim window.\n  this._sendWindowedChunks(this._count);\n  this._count += 1;\n};\n\n// Set up interval for processing queue.\nReliable.prototype._setupInterval = function() {\n  // TODO: fail gracefully.\n\n  var self = this;\n  this._timeout = setInterval(function() {\n    // FIXME: String stuff makes things terribly async.\n    var msg = self._queue.shift();\n    if (msg._multiple) {\n      for (var i = 0, ii = msg.length; i < ii; i += 1) {\n        self._intervalSend(msg[i]);\n      }\n    } else {\n      self._intervalSend(msg);\n    }\n  }, this._interval);\n};\n\nReliable.prototype._intervalSend = function(msg) {\n  var self = this;\n  msg = util.pack(msg);\n  util.blobToBinaryString(msg, function(str) {\n    self._dc.send(str);\n  });\n  if (self._queue.length === 0) {\n    clearTimeout(self._timeout);\n    self._timeout = null;\n    //self._processAcks();\n  }\n};\n\n// Go through ACKs to send missing pieces.\nReliable.prototype._processAcks = function() {\n  for (var id in this._outgoing) {\n    if (this._outgoing.hasOwnProperty(id)) {\n      this._sendWindowedChunks(id);\n    }\n  }\n};\n\n// Handle sending a message.\n// FIXME: Don't wait for interval time for all messages...\nReliable.prototype._handleSend = function(msg) {\n  var push = true;\n  for (var i = 0, ii = this._queue.length; i < ii; i += 1) {\n    var item = this._queue[i];\n    if (item === msg) {\n      push = false;\n    } else if (item._multiple && item.indexOf(msg) !== -1) {\n      push = false;\n    }\n  }\n  if (push) {\n    this._queue.push(msg);\n    if (!this._timeout) {\n      this._setupInterval();\n    }\n  }\n};\n\n// Set up DataChannel handlers.\nReliable.prototype._setupDC = function() {\n  // Handle various message types.\n  var self = this;\n  this._dc.onmessage = function(e) {\n    var msg = e.data;\n    var datatype = msg.constructor;\n    // FIXME: msg is String until binary is supported.\n    // Once that happens, this will have to be smarter.\n    if (datatype === String) {\n      var ab = util.binaryStringToArrayBuffer(msg);\n      msg = util.unpack(ab);\n      self._handleMessage(msg);\n    }\n  };\n};\n\n// Handles an incoming message.\nReliable.prototype._handleMessage = function(msg) {\n  var id = msg[1];\n  var idata = this._incoming[id];\n  var odata = this._outgoing[id];\n  var data;\n  switch (msg[0]) {\n    // No chunking was done.\n    case 'no':\n      var message = id;\n      if (!!message) {\n        this.onmessage(util.unpack(message));\n      }\n      break;\n    // Reached the end of the message.\n    case 'end':\n      data = idata;\n\n      // In case end comes first.\n      this._received[id] = msg[2];\n\n      if (!data) {\n        break;\n      }\n\n      this._ack(id);\n      break;\n    case 'ack':\n      data = odata;\n      if (!!data) {\n        var ack = msg[2];\n        // Take the larger ACK, for out of order messages.\n        data.ack = Math.max(ack, data.ack);\n\n        // Clean up when all chunks are ACKed.\n        if (data.ack >= data.chunks.length) {\n          util.log('Time: ', new Date() - data.timer);\n          delete this._outgoing[id];\n        } else {\n          this._processAcks();\n        }\n      }\n      // If !data, just ignore.\n      break;\n    // Received a chunk of data.\n    case 'chunk':\n      // Create a new entry if none exists.\n      data = idata;\n      if (!data) {\n        var end = this._received[id];\n        if (end === true) {\n          break;\n        }\n        data = {\n          ack: ['ack', id, 0],\n          chunks: []\n        };\n        this._incoming[id] = data;\n      }\n\n      var n = msg[2];\n      var chunk = msg[3];\n      data.chunks[n] = new Uint8Array(chunk);\n\n      // If we get the chunk we're looking for, ACK for next missing.\n      // Otherwise, ACK the same N again.\n      if (n === data.ack[2]) {\n        this._calculateNextAck(id);\n      }\n      this._ack(id);\n      break;\n    default:\n      // Shouldn't happen, but would make sense for message to just go\n      // through as is.\n      this._handleSend(msg);\n      break;\n  }\n};\n\n// Chunks BL into smaller messages.\nReliable.prototype._chunk = function(bl) {\n  var chunks = [];\n  var size = bl.size;\n  var start = 0;\n  while (start < size) {\n    var end = Math.min(size, start + this._mtu);\n    var b = bl.slice(start, end);\n    var chunk = {\n      payload: b\n    }\n    chunks.push(chunk);\n    start = end;\n  }\n  util.log('Created', chunks.length, 'chunks.');\n  return chunks;\n};\n\n// Sends ACK N, expecting Nth blob chunk for message ID.\nReliable.prototype._ack = function(id) {\n  var ack = this._incoming[id].ack;\n\n  // if ack is the end value, then call _complete.\n  if (this._received[id] === ack[2]) {\n    this._complete(id);\n    this._received[id] = true;\n  }\n\n  this._handleSend(ack);\n};\n\n// Calculates the next ACK number, given chunks.\nReliable.prototype._calculateNextAck = function(id) {\n  var data = this._incoming[id];\n  var chunks = data.chunks;\n  for (var i = 0, ii = chunks.length; i < ii; i += 1) {\n    // This chunk is missing!!! Better ACK for it.\n    if (chunks[i] === undefined) {\n      data.ack[2] = i;\n      return;\n    }\n  }\n  data.ack[2] = chunks.length;\n};\n\n// Sends the next window of chunks.\nReliable.prototype._sendWindowedChunks = function(id) {\n  util.log('sendWindowedChunks for: ', id);\n  var data = this._outgoing[id];\n  var ch = data.chunks;\n  var chunks = [];\n  var limit = Math.min(data.ack + this._window, ch.length);\n  for (var i = data.ack; i < limit; i += 1) {\n    if (!ch[i].sent || i === data.ack) {\n      ch[i].sent = true;\n      chunks.push(['chunk', id, i, ch[i].payload]);\n    }\n  }\n  if (data.ack + this._window >= ch.length) {\n    chunks.push(['end', id, ch.length])\n  }\n  chunks._multiple = true;\n  this._handleSend(chunks);\n};\n\n// Puts together a message from chunks.\nReliable.prototype._complete = function(id) {\n  util.log('Completed called for', id);\n  var self = this;\n  var chunks = this._incoming[id].chunks;\n  var bl = new Blob(chunks);\n  util.blobToArrayBuffer(bl, function(ab) {\n    self.onmessage(util.unpack(ab));\n  });\n  delete this._incoming[id];\n};\n\n// Ups bandwidth limit on SDP. Meant to be called during offer/answer.\nReliable.higherBandwidthSDP = function(sdp) {\n  // AS stands for Application-Specific Maximum.\n  // Bandwidth number is in kilobits / sec.\n  // See RFC for more info: http://www.ietf.org/rfc/rfc2327.txt\n\n  // Chrome 31+ doesn't want us munging the SDP, so we'll let them have their\n  // way.\n  var version = navigator.appVersion.match(/Chrome\\/(.*?) /);\n  if (version) {\n    version = parseInt(version[1].split('.').shift());\n    if (version < 31) {\n      var parts = sdp.split('b=AS:30');\n      var replace = 'b=AS:102400'; // 100 Mbps\n      if (parts.length > 1) {\n        return parts[0] + replace + parts[1];\n      }\n    }\n  }\n\n  return sdp;\n};\n\n// Overwritten, typically.\nReliable.prototype.onmessage = function(msg) {};\n\nmodule.exports.Reliable = Reliable;\n\n},{\"./util\":13}],13:[function(require,module,exports){\nvar BinaryPack = require('js-binarypack');\n\nvar util = {\n  debug: false,\n\n  inherits: function(ctor, superCtor) {\n    ctor.super_ = superCtor;\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  },\n  extend: function(dest, source) {\n    for(var key in source) {\n      if(source.hasOwnProperty(key)) {\n        dest[key] = source[key];\n      }\n    }\n    return dest;\n  },\n  pack: BinaryPack.pack,\n  unpack: BinaryPack.unpack,\n\n  log: function () {\n    if (util.debug) {\n      var copy = [];\n      for (var i = 0; i < arguments.length; i++) {\n        copy[i] = arguments[i];\n      }\n      copy.unshift('Reliable: ');\n      console.log.apply(console, copy);\n    }\n  },\n\n  setZeroTimeout: (function(global) {\n    var timeouts = [];\n    var messageName = 'zero-timeout-message';\n\n    // Like setTimeout, but only takes a function argument.\t There's\n    // no time argument (always zero) and no arguments (you have to\n    // use a closure).\n    function setZeroTimeoutPostMessage(fn) {\n      timeouts.push(fn);\n      global.postMessage(messageName, '*');\n    }\n\n    function handleMessage(event) {\n      if (event.source == global && event.data == messageName) {\n        if (event.stopPropagation) {\n          event.stopPropagation();\n        }\n        if (timeouts.length) {\n          timeouts.shift()();\n        }\n      }\n    }\n    if (global.addEventListener) {\n      global.addEventListener('message', handleMessage, true);\n    } else if (global.attachEvent) {\n      global.attachEvent('onmessage', handleMessage);\n    }\n    return setZeroTimeoutPostMessage;\n  }(this)),\n\n  blobToArrayBuffer: function(blob, cb){\n    var fr = new FileReader();\n    fr.onload = function(evt) {\n      cb(evt.target.result);\n    };\n    fr.readAsArrayBuffer(blob);\n  },\n  blobToBinaryString: function(blob, cb){\n    var fr = new FileReader();\n    fr.onload = function(evt) {\n      cb(evt.target.result);\n    };\n    fr.readAsBinaryString(blob);\n  },\n  binaryStringToArrayBuffer: function(binary) {\n    var byteArray = new Uint8Array(binary.length);\n    for (var i = 0; i < binary.length; i++) {\n      byteArray[i] = binary.charCodeAt(i) & 0xff;\n    }\n    return byteArray.buffer;\n  },\n  randomToken: function () {\n    return Math.random().toString(36).substr(2);\n  }\n};\n\nmodule.exports = util;\n\n},{\"js-binarypack\":10}]},{},[3]);\n","if (Meteor.isClient) {\n  Template.hello.events({\n    \"click #makeCall\": function () {\n      var user = this;\n      var outgoingCall = peer.call(user.profile.peerId, window.localStream);\n      window.currentCall = outgoingCall;\n      outgoingCall.on('stream', function (remoteStream) {\n        window.remoteStream = remoteStream;\n        var video = document.getElementById(\"theirVideo\")\n        video.src = URL.createObjectURL(remoteStream);\n      });\n    },\n    \"click #endCall\": function () {\n      window.currentCall.close();\n    }\n  });\n\n  Template.hello.helpers({\n    users: function () {\n      // exclude the currentUser\n      var userIds = Presences.find().map(function(presence) {return presence.userId;});\n      return Meteor.users.find({_id: {$in: userIds, $ne: Meteor.userId()}});\n    }\n  });\n\n  Template.hello.onCreated(function () {\n    Meteor.subscribe(\"presences\");\n    Meteor.subscribe(\"users\");\n\n    window.peer = new Peer({\n      key: 's5fcjmfdi5vfs9k9',  // change this key\n      debug: 3,\n      config: {'iceServers': [\n        { url: 'stun:stun.l.google.com:19302' },\n        { url: 'stun:stun1.l.google.com:19302' },\n      ]}\n    });\n\n    // This event: remote peer receives a call\n    peer.on('open', function () {\n      $('#myPeerId').text(peer.id);\n      // update the current user's profile\n      Meteor.users.update({_id: Meteor.userId()}, {\n        $set: {\n          profile: { peerId: peer.id}\n        }\n      });\n    });\n\n    // This event: remote peer receives a call\n    peer.on('call', function (incomingCall) {\n      window.currentCall = incomingCall;\n      incomingCall.answer(window.localStream);\n      incomingCall.on('stream', function (remoteStream) {\n        window.remoteStream = remoteStream;\n        var video = document.getElementById(\"theirVideo\")\n        video.src = URL.createObjectURL(remoteStream);\n      });\n    });\n\n    navigator.getUserMedia = ( navigator.getUserMedia ||\n                      navigator.webkitGetUserMedia ||\n                      navigator.mozGetUserMedia ||\n                      navigator.msGetUserMedia );\n\n    // get audio/video\n    navigator.getUserMedia({audio:true, video: true}, function (stream) {\n      //display video\n      var video = document.getElementById(\"myVideo\");\n      video.src = URL.createObjectURL(stream);\n      window.localStream = stream;\n    }, function (error) { console.log(error); }\n    );\n\n  });\n\n}\n","Accounts.ui.config({\n  passwordSignupFields: 'USERNAME_AND_EMAIL',\n  extraSignupFields: [\n    {\n        fieldName: 'last-name',\n        fieldLabel: 'Last name',\n        inputType: 'text',\n        visible: true,\n    },\n    {\n        fieldName: 'meetingId',\n        fieldLabel: 'meetingId',\n        inputType: 'text',\n        visible: false,\n    }\n  ]\n});\n","\n\nTemplate.create.events({\n  //CrÃ©ation d'un nouveau champ de saisie lorsqu'un caractÃ¨re est renseignÃ©\n  'keyup .participant-email-input': function(e) {\n    var input = $(e.target);\n    if (input.val().length > 0) {\n      var rank = input.parents(\".participant-email\")[0].getAttribute('rank');\n      var form = input.parents(\"#create-form\");\n      var nextRank = parseInt(rank) + 1;\n\n      if ($(form).find('.participant-email[rank=\"'+nextRank+'\"]').length < 1) {\n        var newInput = $(input.parents(\".participant-email\")[0].cloneNode(true));\n        newInput.find(\".participant-email-input\").val(\"\");\n        newInput.attr('rank', nextRank);\n        $(input.parents(\".participant-email-group\")[0]).append(newInput)\n      }\n    }\n  },\n\n\n  'submit form': function(e) {\n    e.preventDefault();\n    //RÃ©cupÃ©ration des Ã©lÃ©ments DOM des champs de saisie\n    var ordreInputs = e.target.ordreDuJour;\n    var ordreTimeInputs = e.target.ordreDuJourTemps;\n    var participantsInputs = e.target.participantsEmails;\n\n    //RÃ©cupÃ©ration des valeurs de l'ordre du jour, temps estimÃ©s et des emails d'invitation\n    var ordres = [];\n    var ordreTimes = [];\n    var participantsEmails = [];\n    var participantActivity = [];\n\n    //RÃ©cupÃ©ration des Ã©lÃ©ments DOM des champs de saisie\n    var participantsInputs = $(e.target).find('[name=participantsEmails]');\n\n\n\n    for (i = 0; i < participantsInputs.length; i++) {\n      if (participantsInputs[i].value != \"\") {\n        participantsEmails.push(participantsInputs[i].value);\n        participantActivity.push(false);\n      }\n    }\n\n    //CrÃ©ation du meeting\n    //voir comment rajouter des personnes au meeting\n    //idÃ©e : crÃ©ation d'un tableau qui est rempli en faisant Meteor.user().mettingId = meetingId\n\n    var meeting= {\n      name: e.target.meetingName.value,\n      duration : e.target.meetingDuration.value,\n      animatorName: e.target.animatorName.value,\n      animatorMail:e.target.animatorEmail.value,\n      participantsEmails: participantsEmails,\n      participantActivity:participantActivity,\n      status: 'ongoing',\n      ordres: ordres,\n      ordreTimes: ordreTimes,\n      speaker: e.target.animatorEmail.value\n    };\n\n    Meteor.call('meetingInsert', meeting, function(error, result) {\n      // affiche l'erreur Ã  l'utilisateur et s'interrompt\n      if (error)\n      return alert(error.reason);\n\n      var meetingId=result._id;\n\n      var emailBody = 'Here is the link for the meeting : taketalk.meteor.com/join/' + meetingId + '\\n';\n      Meteor.call('sendEmail',\n      e.target.animatorEmail.value,\n      'noreply@taketalk.com',\n      'TakeTalk session created',\n      'You have just created a session of TakeTalk. \\n\\n' + emailBody\n    );\n\n\n    for(var i = 0; i < participantsEmails.length; i++) {\n      Meteor.call('sendEmail', participantsEmails[i], 'noreply@taketalk.com', 'TakeTalk invitation',\n      'You are invited to a session of TakeTalk. \\n\\n' + emailBody\n    );\n  }\n\n  console.log(\"mail envoyÃ©\");\n  //Redirection vers la page du meeting\n  Router.go('/meeting/' + meetingId);\n\n});\n}\n});\n\nTemplate.create.onRendered(function (){\n  if (Meteor.userId() != null){\n    $(' #animatorName').val(Meteor.user().username);\n    $(' #animatorEmail').val(Meteor.user().emails[0].address);\n  };\n});\nTemplate.tempName.onRendered(function() {\n\n      var d= new Date();\n      d.setHours(0,0,0);\n      $('.datetimepicker').datetimepicker({\n        format:'HH:mm',\n        defaultDate:d\n      //  defaultViewDate : {hours : 00, minutes: 00}\n    });\n});\n","Template.home.events({\n    //Redirection vers la page de crÃ©ation de meeting\n    'click #open': function(e){\n        Router.go('create');\n    }\n});\n","//import { Template } from 'meteor/templating';\n//import { ReactiveVar } from 'meteor/reactive-var';\n\nvar sortableList;\nvar meeting;\n\n//Template.meeting.isTrue = true;\n//console.log(Template.meeting.isTrue);\n\nPresence.state = function() {\n  return {\n    online:true,\n    currentRoomId: Session.get('currentRoomId')\n  };\n};\n\n\nTemplate.meeting.helpers({\n  users: function () {\n        // exclude the currentUser\n        var userIds = Presences.find().map(function(presence) {return presence.userId;});\n        var userPres = Presences.find().map(function(presence) {\n          if(presence.state.currentRoomId===Session.get('currentRoomId'))\n            return presence.userId;\n        });\n        /*\n        console.log(\"je suis connectÃ©  \" +userIds);\n        console.log(\"je suis ici  \" + userPres);*/\n        return Meteor.users.find({_id: {$in: userPres, $ne: Meteor.userId()}});\n      },\n\n  getSpeaker: function(){\n    meeting=Session.get(\"meeting\");\n      var speaker = Meetings.findOne({_id:meeting._id}).speaker;\n      Session.set(\"speaker\",speaker);\n\n  },\n\n  isSpeaker: function(){\n      meeting=Session.get(\"meeting\");\n      speaker=Session.get(\"speaker\");\n      var mail;\n      if(this.animatorMail)\n        mail=this.animatorMail;\n      else\n        mail=\"\"+this;\n      return Meetings.findOne({_id:meeting._id}).speaker === mail;\n  },\n\n\nisAsking: function(){\n    meeting=Session.get(\"meeting\");\n    var mail;\n    if(this.animatorMail)\n      mail=this.animatorMail;\n    else\n      mail=\"\"+this;\n    return Speeches.find({myMeetingId:meeting._id,speakers:mail}).count();\n},\n\n\n/*\n  onLoad:function(){\n    var meeting = this;\n    Session.set(\"meeting\",this);\n    Session.set('currentRoomId',this._id);\n    var idMeeting=this._id;\n    var meetingParticipant= this.participantsEmails;\n    var meetingParticipantActivity = this.participantActivity;\n\n  },\n*/\n  ownMeeting:function(){\n    meeting=Session.get(\"meeting\");\n    return meeting.animatorMail === Meteor.user().emails[0].address;\n  },\n  partMeeting:function(){\n    var res=0;\n    if(this.animatorMail === Meteor.user().emails[0].address){\n      res=1;\n    }\n    else{\n      var mail=\"\"+this;\n      if(mail===Meteor.user().emails[0].address)\n        res=1;\n\n      meeting=Session.get(\"meeting\");\n\n/*\n      for(i=0;i<meeting.participantsEmails.length;i++){\n        if(meeting.participantsEmails[i]===Meteor.user().emails[0].address){\n\n          Meetings.update(idMeeting,{$set: {\"meetingParticipantActivity[i]\": true}});\n\n          i=this.participantsEmails.length;\n        }\n      }\n*/\n    }\n\n    return res;\n  }\n});\n\nTemplate.meeting.events({\n  'click #speakControl' : function(e){\n    console.log(meeting._id);\n    meeting=Session.get(\"meeting\");\n    speeches=Speeches.findOne({myMeetingId:meeting._id});\n    if(this.animatorMail){\n      Meetings.update(meeting._id, {$set: {speaker: this.animatorMail}});\n    }\n    else {\n      var mail=\"\"+this;\n      Meetings.update(meeting._id, {$set: {speaker: mail}});\n        Speeches.update(speeches._id , {$pull: {speakers: mail }} );\n    }\n\n  },\n\n'click #speakAsk' : function(e){\n  meeting=Session.get(\"meeting\");\n  speeches=Speeches.findOne({myMeetingId:meeting._id});\n\n\n\n    var mail=\"\"+this;\n    Speeches.update(speeches._id , {$push: {speakers: mail }} );\n},\n'click #inviteSubmit' : function(e){\n  meeting=Session.get(\"meeting\");\n  //speeches=Speeches.findOne({myMeetingId:meeting._id});\n\n  var newParticipant=document.querySelectorAll('#newParticipant')[0].value;\n  Meetings.update(meeting._id , {$push: {participantsEmails: newParticipant }} );\n},\n\n  'click #talkCancel' : function(e){\n    console.log(\"I click on Talk\");\n    //Ã  modifier\n      var userId = Meteor.user().username;\n      var meetingId = Meteor.user().meeting;\n      var rank = 1;\n      console.log(\"userId = \" + userId);\n      console.log(\"meeting = \" + meetingId);\n  },\n\n\n  /** A click on waitProceed starts or stops the timer */\n  'click #waitProceed': function(e) {\n    //Arret du timer\n    if(e.target.value == \"Wait\") {\n      Meteor.clearInterval(timerId);\n      Speeches.update(\n        Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"ongoing\"})._id,\n        {$set: {status: \"pending\"}}\n      );\n    } else {\n      Speeches.update(\n        Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"pending\"}, {sort: {rank: 1}})._id,\n        {$set: {status: \"ongoing\"}}\n      );\n\n      //Lancement du timer\n      timerId = Meteor.setInterval(function() {\n        var currentSpeech = Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"ongoing\"});\n        var user = Users.findOne({_id:currentSpeech.user});\n        var paroles = [];\n        var time = 1;\n\n        //IncrÃ©mentation du compteur associÃ© a l'ordre du speech\n        if (user.paroles === undefined) {\n          paroles.push({\"order\": currentSpeech.orderChoose, \"time\": 1});\n        } else {\n          var paroleFound = false;\n          paroles = user.paroles;\n          paroles.forEach(function (el) {\n            if (el['order'] == currentSpeech.orderChoose) {\n              paroleFound = true;\n              el['time'] = parseInt(el['time'])+1;\n            }\n          });\n          if (!paroleFound) {\n            paroles.push({\"order\": currentSpeech.orderChoose, \"time\": 1});\n          }\n        }\n\n        Users.update(user._id,  {$set: {paroles: paroles}});\n\n        //Update du temps restant du speech\n        Speeches.update(\n          currentSpeech._id,\n          {$set: {timeLeft: Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"ongoing\"}).timeLeft + 1}}\n        );\n        //Update du statut du speech si celui ci est terminÃ©\n        if(Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"ongoing\"}).timeLeft == Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"ongoing\"}).time){\n          Speeches.update(\n            Speeches.findOne({meeting: Session.get(\"meetingId\"), status: \"ongoing\"})._id,\n            {$set: {status: \"done\"}}\n          );\n          Meteor.clearInterval(timerId);\n        }\n      } , 1000);\n    }\n    //Rafraichi la fonction de drag'n'drop\n    //Utile pour empÃªcher le dÃ©placement du premier meeting quand on clique sur 'proceed'\n    //trouver une autre solution (la mÃ©thode \"refresh\" semble inefficace)\n      setTimeout(function () {\n      sortableList.sortable(\"destroy\");\n      computeSortable(sortableList);\n    }, 100)\n    ;\n  },\n\n});\n\n\nTemplate.meeting.onCreated(function () {\n  Meteor.subscribe(\"presences\");\n  Meteor.subscribe(\"users\");\n\n//   meeting = this.data;\n  Session.set(\"meeting\",this.data);\n  Session.set('currentRoomId',this._id);\n\n});\n\n\n\n\n\n\n\n//summernote : don't touch\nTemplate.meeting.onRendered(function () {\n$(document).ready(function(){\n  $('#textareaRich').summernote({\n    height: 300,\n  });\n});\n});\n\n\n\nTemplate.meeting.events({\n  'click #saveReport' :function(e) {\n    // increment the counter when button is clicked\n    console.log(\"I click on Talk\");\n    var title = $(' #TitleReport').val();\n    var data = $('#textareaRich').summernote('code');\n    //$('.click2edit').summernote('destroy');\n    console.log(\"title :\" + title + \" data = \" + data);\n    var doc = new jsPDF();\n    doc.text(10,10,data);\n    doc.save(title);\n    //Fonctionne mais enregistre en .txt\n    //var blob = new Blob([data], {type: \"text/plain;charset=utf-8\"});\n    //saveAs(blob, title+\".txt\");\n  }\n});\n","\nTemplate.meetingReport.onRendered(function () {\n  $(document).ready(function(){\n    $('#textareaRich').summernote({\n      height: 300,\n    });\n  });\n});\n\n\n\nTemplate.meetingReport.events({\n  'click #saveReport' :function(e) {\n    // increment the counter when button is clicked\n    console.log(\"I click on Talk\");\n    var title = $(' #TitleReport').val();\n    var data = $('#textareaRich').summernote('code');\n    //$('.click2edit').summernote('destroy');\n    console.log(\"title :\" + title + \" data = \" + data);\n    var doc = new jsPDF();\n    doc.text(10,10,data);\n    doc.save(title);\n    //Fonctionne mais enregistre en .txt\n    //var blob = new Blob([data], {type: \"text/plain;charset=utf-8\"});\n    //saveAs(blob, title+\".txt\");\n  },\n  'click #goppt' : function(e){\n    console.log(\"GoPPT\");\n    Template.meeting.isTrue = false;\n    console.log(Template.meeting.isTrue);\n\n  },\n});\n\nTemplate.pptcont.events({\n  'click #gomt' : function(e){\n    console.log(\"GoMT\");\n    console.log(Template.meeting.isTrue.value());\n\n    Template.meeting.isTrue = true;\n  },\n});\n\n\n\nTemplate.meetingReport.isTrue = true;\n","Groups = new Meteor.Collection('groups');\n\nGroups.allow({\n  update: function(userId, group) { return true/*return ownsDocument(userId, group);*/ },\n  remove: function(userId, group) { return ownsDocument(userId, group); },\n  insert: function(userId, doc) {\n    // autoriser les posts seulement si l'utilisateur est authentifiÃ©\n    return !! userId;\n  }\n });\n\n Meteor.methods({\n     groupInsert: function(groupAttributes) {\n         check(Meteor.userId(), String);\n         check(groupAttributes, {\n             name: String,\n             members: [String]\n         });\n\n         var user = Meteor.user();\n         var group = _.extend(groupAttributes, {\n             userId: user._id,\n             author: user.emails,\n             authorAdress: user.emails[0].address,\n             authorName : user.username,\n             submitted: new Date()\n         });\n         var groupId = Groups.insert(group);\n         return {\n             _id: groupId\n         };\n     }\n });\n","/** The collection that contains the meetings */\nMeetings = new Mongo.Collection(\"meetings\");\n\nMeetings.allow({\n  update: function() { return true/*return ownsDocument(userId, group);*/ },\n  remove: function() { return true },\n  insert: function() {\n    return true;\n  }\n });\n\n\n Meteor.methods({\n     meetingInsert: function(meetingAttributes) {\n\n         check(meetingAttributes, {\n             name: String,\n             duration: String,\n             animatorName: String,\n             animatorMail:String,\n             participantsEmails: [String],\n             participantActivity: [Boolean],\n             status: String,\n             ordres: [String],\n             ordreTimes: [Number],\n             speaker:String/*,\n             pwd : \"\" */\n         });\n\n         var meeting = _.extend(meetingAttributes, {\n             submitted: new Date()\n         });\n         var meetingId = Meetings.insert(meeting);\n\n\n         return {\n             _id: meetingId\n         };\n     }\n });\n\n/*\n Exemple :\n\n name: 'test',\n status: \"ongoing\",\n ordres: ['ordre1', 'ordre2', 'ordre3'],\n ordreTimes: [90, 130, 268],\n _id: id\n pwd : \"\"\n */\n","/** The collection that contains the speeches */\nSpeeches = new Mongo.Collection(\"speeches\");\n\nSpeeches.allow({\n  update: function() { return true/*return ownsDocument(userId, group);*/ },\n  remove: function() { return true },\n  insert: function() {\n    return true;\n  }\n });\n\n\n Meteor.methods({\n     speechesInsert: function(speechesAttributes) {\n\n         check(speechesAttributes, {\n             meetingID: String/*,\n             speakers: [String]\n             */\n         });\n\n\n\n         var speechesId = Speeches.insert(speechesAttributes);\n\n\n         return {\n             _id: speechesId\n         };\n     }\n });\n","Router.configure({\n  layoutTemplate: 'layout',\n  waitOn: function(){\n    return [\n      Meteor.subscribe('groups'),\n      Meteor.subscribe('meetings')\n    ]},\n    /*return Meteor.subscribe('groups'); },\n  waitOn: function(){return Meteor.subscribe('meetings'); }\n  */\n});\n\n/** The route to the home page */\nRouter.route('/', {name:'home'});\n\nRouter.route('/create/:_id?', {\n  name: 'create',\n  data: function() { return Groups.findOne(this.params._id); }\n});\n\nRouter.route('/groups', {name:'groups'});\nRouter.route('/groupSubmit', {name:'groupSubmit'});\nRouter.route('/groups/:_id', {\n  name: 'groupPage',\n  data: function() { return Groups.findOne(this.params._id); }\n});\n\n\nRouter.route('/meeting/:_meetingId', {\n  name: 'meeting',\n  data: function() {\n  // Recherche du meeting dont l'id est passÃ© en paramÃ¨tre\n  // Redirection vers une page d'erreur \"404 not found\" lorsqu'aucun meeting n'est trouvÃ©\n    var meeting = Meetings.findOne({_id: this.params._meetingId, status: \"ongoing\"});\n\n  //  console.log(meeting);\n    if(meeting === undefined){\n      //  console.log('undefined meeting...');\n        Router.configure({layoutTemplate: 'layout', notFoundTemplate: '404'});\n    }\n    else\n      return  Meetings.findOne({_id: this.params._meetingId, status: \"ongoing\"});\n\n  }\n});\n\nRouter.route('/join/:_meetingId/:_userId', {\n    name: 'join',\n    data: function() {\n\n        // Recherche du meeting dont l'id est passÃ© en paramÃ¨tre\n        // Redirection vers une page d'erreur \"404 not found\" lorsqu'aucun meeting n'est trouvÃ©\n        var meeting = Meetings.findOne({_id: this.params._meetingId});\n        if(meeting === undefined){\n            console.log('meeting undefined');\n            Router.configure({layoutTemplate: 'layout', notFoundTemplate: '404'});\n        }\n\n        //Recherche de l'utilisateur\n        //Redirection vers une page d'erreur \"404 not found\" lorsqu'aucun utilisateur n'est trouvÃ©\n        //Ne permet qu'aux utilisateurs invitÃ©s de rejoindre un meeting\n        var user = MeetingUsers.findOne({_id: this.params._userId});\n        if(user === undefined){\n            console.log('user undefined');\n            Router.configure({layoutTemplate: 'layout', notFoundTemplate: '404'});\n        }\n\n        Session.set(\"meetingId\", this.params._meetingId);\n        Session.set(\"userId\", this.params._userId);\n\n        return {};\n    }\n});\n\nRouter.route('/meeting/:_meetingId/lineup', function () {\n    this.render('lineup');\n});\n\nRouter.route('/end', function () {\n    this.render('end');\n});\n"]}