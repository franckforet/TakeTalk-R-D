{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/js/create.js","filenameRelative":"/client/js/create.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/js/create.js.map","sourceFileName":"/client/js/create.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"create"},"ignored":false,"code":"Template.create.events({\n  //Création d'un nouveau champ de saisie lorsqu'un caractère est renseigné\n  'keyup .participant-email-input': function (e) {\n    var input = $(e.target);\n\n    if (input.val().length > 0) {\n      var rank = input.parents(\".participant-email\")[0].getAttribute('rank');\n      var form = input.parents(\"#create-form\");\n      var nextRank = parseInt(rank) + 1;\n\n      if ($(form).find('.participant-email[rank=\"' + nextRank + '\"]').length < 1) {\n        var newInput = $(input.parents(\".participant-email\")[0].cloneNode(true));\n        newInput.find(\".participant-email-input\").val(\"\");\n        newInput.attr('rank', nextRank);\n        $(input.parents(\".participant-email-group\")[0]).append(newInput);\n      }\n    }\n  },\n  'submit form': function (e) {\n    e.preventDefault(); //Récupération des éléments DOM des champs de saisie\n\n    var ordreInputs = e.target.ordreDuJour;\n    var ordreTimeInputs = e.target.ordreDuJourTemps;\n    var participantsInputs = e.target.participantsEmails; //Récupération des valeurs de l'ordre du jour, temps estimés et des emails d'invitation\n\n    var ordres = [];\n    var ordreTimes = [];\n    var participantsEmails = [];\n    var participantActivity = []; //Récupération des éléments DOM des champs de saisie\n\n    var participantsInputs = $(e.target).find('[name=participantsEmails]');\n\n    for (i = 0; i < participantsInputs.length; i++) {\n      if (participantsInputs[i].value != \"\") {\n        participantsEmails.push(participantsInputs[i].value);\n        participantActivity.push(false);\n      }\n    } //Création du meeting\n    //voir comment rajouter des personnes au meeting\n    //idée : création d'un tableau qui est rempli en faisant Meteor.user().mettingId = meetingId\n\n\n    var meeting = {\n      name: e.target.meetingName.value,\n      duration: e.target.meetingDuration.value,\n      animatorName: e.target.animatorName.value,\n      animatorMail: e.target.animatorEmail.value,\n      participantsEmails: participantsEmails,\n      participantActivity: participantActivity,\n      status: 'ongoing',\n      ordres: ordres,\n      ordreTimes: ordreTimes,\n      speaker: e.target.animatorEmail.value\n    };\n    Meteor.call('meetingInsert', meeting, function (error, result) {\n      // affiche l'erreur à l'utilisateur et s'interrompt\n      if (error) return alert(error.reason);\n      var meetingId = result._id;\n      var emailBody = 'Here is the link for the meeting : taketalk.meteor.com/join/' + meetingId + '\\n';\n      Meteor.call('sendEmail', e.target.animatorEmail.value, 'noreply@taketalk.com', 'TakeTalk session created', 'You have just created a session of TakeTalk. \\n\\n' + emailBody);\n\n      for (var i = 0; i < participantsEmails.length; i++) {\n        Meteor.call('sendEmail', participantsEmails[i], 'noreply@taketalk.com', 'TakeTalk invitation', 'You are invited to a session of TakeTalk. \\n\\n' + emailBody);\n      }\n\n      console.log(\"mail envoyé\"); //Redirection vers la page du meeting\n\n      Router.go('/meeting/' + meetingId);\n    });\n  }\n});\nTemplate.create.onRendered(function () {\n  if (Meteor.userId() != null) {\n    $(' #animatorName').val(Meteor.user().username);\n    $(' #animatorEmail').val(Meteor.user().emails[0].address);\n  }\n\n  ;\n});\nTemplate.tempName.onRendered(function () {\n  var d = new Date();\n  d.setHours(0, 0, 0);\n  $('.datetimepicker').datetimepicker({\n    format: 'HH:mm',\n    defaultDate: d //  defaultViewDate : {hours : 00, minutes: 00}\n\n  });\n});","ast":null,"map":{"version":3,"sources":["/client/js/create.js"],"names":["Template","create","events","e","input","$","target","val","length","rank","parents","getAttribute","form","nextRank","parseInt","find","newInput","cloneNode","attr","append","preventDefault","ordreInputs","ordreDuJour","ordreTimeInputs","ordreDuJourTemps","participantsInputs","participantsEmails","ordres","ordreTimes","participantActivity","i","value","push","meeting","name","meetingName","duration","meetingDuration","animatorName","animatorMail","animatorEmail","status","speaker","Meteor","call","error","result","alert","reason","meetingId","_id","emailBody","console","log","Router","go","onRendered","userId","user","username","emails","address","tempName","d","Date","setHours","datetimepicker","format","defaultDate"],"mappings":"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","file":"/client/js/create.js.map","sourcesContent":["\n\nTemplate.create.events({\n  //Création d'un nouveau champ de saisie lorsqu'un caractère est renseigné\n  'keyup .participant-email-input': function(e) {\n    var input = $(e.target);\n    if (input.val().length > 0) {\n      var rank = input.parents(\".participant-email\")[0].getAttribute('rank');\n      var form = input.parents(\"#create-form\");\n      var nextRank = parseInt(rank) + 1;\n\n      if ($(form).find('.participant-email[rank=\"'+nextRank+'\"]').length < 1) {\n        var newInput = $(input.parents(\".participant-email\")[0].cloneNode(true));\n        newInput.find(\".participant-email-input\").val(\"\");\n        newInput.attr('rank', nextRank);\n        $(input.parents(\".participant-email-group\")[0]).append(newInput)\n      }\n    }\n  },\n\n\n  'submit form': function(e) {\n    e.preventDefault();\n    //Récupération des éléments DOM des champs de saisie\n    var ordreInputs = e.target.ordreDuJour;\n    var ordreTimeInputs = e.target.ordreDuJourTemps;\n    var participantsInputs = e.target.participantsEmails;\n\n    //Récupération des valeurs de l'ordre du jour, temps estimés et des emails d'invitation\n    var ordres = [];\n    var ordreTimes = [];\n    var participantsEmails = [];\n    var participantActivity = [];\n\n    //Récupération des éléments DOM des champs de saisie\n    var participantsInputs = $(e.target).find('[name=participantsEmails]');\n\n\n\n    for (i = 0; i < participantsInputs.length; i++) {\n      if (participantsInputs[i].value != \"\") {\n        participantsEmails.push(participantsInputs[i].value);\n        participantActivity.push(false);\n      }\n    }\n\n    //Création du meeting\n    //voir comment rajouter des personnes au meeting\n    //idée : création d'un tableau qui est rempli en faisant Meteor.user().mettingId = meetingId\n\n    var meeting= {\n      name: e.target.meetingName.value,\n      duration : e.target.meetingDuration.value,\n      animatorName: e.target.animatorName.value,\n      animatorMail:e.target.animatorEmail.value,\n      participantsEmails: participantsEmails,\n      participantActivity:participantActivity,\n      status: 'ongoing',\n      ordres: ordres,\n      ordreTimes: ordreTimes,\n      speaker: e.target.animatorEmail.value\n    };\n\n    Meteor.call('meetingInsert', meeting, function(error, result) {\n      // affiche l'erreur à l'utilisateur et s'interrompt\n      if (error)\n      return alert(error.reason);\n\n      var meetingId=result._id;\n\n      var emailBody = 'Here is the link for the meeting : taketalk.meteor.com/join/' + meetingId + '\\n';\n      Meteor.call('sendEmail',\n      e.target.animatorEmail.value,\n      'noreply@taketalk.com',\n      'TakeTalk session created',\n      'You have just created a session of TakeTalk. \\n\\n' + emailBody\n    );\n\n\n    for(var i = 0; i < participantsEmails.length; i++) {\n      Meteor.call('sendEmail', participantsEmails[i], 'noreply@taketalk.com', 'TakeTalk invitation',\n      'You are invited to a session of TakeTalk. \\n\\n' + emailBody\n    );\n  }\n\n  console.log(\"mail envoyé\");\n  //Redirection vers la page du meeting\n  Router.go('/meeting/' + meetingId);\n\n});\n}\n});\n\nTemplate.create.onRendered(function (){\n  if (Meteor.userId() != null){\n    $(' #animatorName').val(Meteor.user().username);\n    $(' #animatorEmail').val(Meteor.user().emails[0].address);\n  };\n});\nTemplate.tempName.onRendered(function() {\n\n      var d= new Date();\n      d.setHours(0,0,0);\n      $('.datetimepicker').datetimepicker({\n        format:'HH:mm',\n        defaultDate:d\n      //  defaultViewDate : {hours : 00, minutes: 00}\n    });\n});\n"]},"hash":"b9b3b34ae1e60de57746f449655b828cb8c56fd3"}
